{% load static %}
{% load staticfiles %}

<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	{% include 'css.html' %}
	{% include 'javascript.html' %}
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <!-- Include Favicon -->
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">

	<title>ArchiTasker - Week Planner Made Simple</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">

    <!-- Bootstrap core CSS     -->
    <link href="{% static 'css/DASHBOARD_CSS/bootstrap.min.css' %}" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="{% static 'css/DASHBOARD_CSS/animate.min.css' %}" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="{% static 'css/DASHBOARD_CSS/light-bootstrap-dashboard.css' %}" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="{% static 'css/DASHBOARD_CSS/demo.css' %}" rel="stylesheet" />


    <link rel="stylesheet" href="http://ericjgagnon.github.io/wickedpicker/wickedpicker/wickedpicker.min.css">
    <script type="text/javascript" src="http://ericjgagnon.github.io/wickedpicker/wickedpicker/wickedpicker.min.js"></script>

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="{% static 'css/DASHBOARD_CSS/pe-icon-7-stroke.css' %}" rel="stylesheet" />

    <link href="http://senthilraj.github.io/TimePicki/css/timepicki.css" rel="stylesheet">

	<script src='http://bgrins.github.io/spectrum/spectrum.js'></script>
	<link rel='stylesheet' href='http://bgrins.github.io/spectrum/spectrum.css' />




	  <script type="text/javascript" src="http://jonthornton.github.io/jquery-timepicker/jquery.timepicker.js"></script>
	  <link rel="stylesheet" type="text/css" href="http://jonthornton.github.io/jquery-timepicker/jquery.timepicker.css" />

<!-- 	  <script type="text/javascript" src="http://jonthornton.github.io/jquery-timepicker/lib/bootstrap-datepicker.js"></script> -->
	  <link rel="stylesheet" type="text/css" href="http://jonthornton.github.io/jquery-timepicker/lib/bootstrap-datepicker.css" />

	  <script type="text/javascript" src="http://jonthornton.github.io/jquery-timepicker/lib/site.js"></script>
	  <link rel="stylesheet" type="text/css" href="http://jonthornton.github.io/jquery-timepicker/lib/site.css" />



	<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <style>
      #locationField, #controls {
        position: relative;
        width: 383px;
      }
      #autocomplete {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 99%;
      }
      .label {
        text-align: right;
        font-weight: bold;
        width: 100px;
        color: #303030;
      }
      #address {
        border: 1px solid #000090;
        background-color: #f0f0ff;
        width: 480px;
        padding-right: 2px;
      }
      #address td {
        font-size: 10pt;
      }
      .field {
        width: 99%;
      }
      .slimField {
        width: 80px;
      }
      .wideField {
        width: 200px;
      }
      #locationField {
        height: 20px;
        margin-bottom: 2px;
      }

	td#addEventForm{
		border-right:1px solid #F1F1F1;
		border-top:1px solid #F1F1F1;
		border-bottom:1px solid #F1F1F1;
		border-left:0px solid #F1F1F1;
		padding:5px;
		margin:0;
	    vertical-align: middle;
	    width: 400x;
	 }


	/* Dropdown Button */
	.dropbtn {
	    background-color: #4CAF50;
	    color: white;
	    padding: 16px;
	    font-size: 16px;
	    border: none;
	    cursor: pointer;
	}

	/* Dropdown button on hover & focus */
	.dropbtn:hover, .dropbtn:focus {
	    background-color: #3e8e41;
	}

	/* The container <div> - needed to position the dropdown content */
	.dropdown {
	    position: relative;
	    display: inline-block;
	}

	/* Dropdown Content (Hidden by Default) */
	.dropdown-content {
	    display: none;
	    position: absolute;
	    background-color: #f9f9f9;
	    min-width: 160px;
	    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
	}

	/* Links inside the dropdown */
	.dropdown-content a {
	    color: black;
	    padding: 12px 16px;
	    text-decoration: none;
	    display: block;
	}

	/* Change color of dropdown links on hover */
	.dropdown-content a:hover {background-color: #f1f1f1}

	/* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
	.show {display:block;}


	@import url('//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css');
	 



.time_pick {
	position: relative;
	width: 500px;
}

    </style>

		<script type="text/javascript" charset="utf-8">

		var event_can_add = false;

            function stringEscape(s) {
                return s ? s.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\t/g,'\\t').replace(/\v/g,'\\v').replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/[\x00-\x1F\x80-\x9F]/g,hex) : s;
                function hex(c) { var v = '0'+c.charCodeAt(0).toString(16); return '\\x'+v.substr(v.length-2); }
            }

			function init() {

                var open_modal_google = function(id, event_color, start, end) {
                    $("#modal_title").html("Google Event Name: <font color=\"" + event_color +"\"><b>" + scheduler.getEvent(id).text + "</b></font>");
                    $("#start_time").html("Start Time: <b>" + start + "</b>");
                    $("#end_time").html("End Time: <b>" + end + "</b>");
                    $('#mymodal').modal('show');
                }

                var open_modal_breakdown_tasks = function(id, event_color, start, end) {
                    $("#modal_title").html("Breakdown Task Name: <font color=\"" + "black" +"\"><b>" + scheduler.getEvent(id).text + "</b></font>");
                    $("#start_time").html("Start Time: <b>" + start + "</b>");
                    $("#end_time").html("End Time: <b>" + end + "</b>");
                    $('#mymodal').modal('show');
                }


				google_ids = [];

				var currently_selected_id = "";
				var current_view = 0;
				var prev_button = document.getElementsByClassName('dhx_cal_prev_button');
				var next_button = document.getElementsByClassName('dhx_cal_next_button');
				next_button[0].style.visibility='hidden';

				// HANDLE PREVIOUS EVENTS
				for (var i = 0; i < prev_button.length; i++) {
						prev_button[i].addEventListener('click', function() {
								current_view-=1;
								if (current_view > 0) {
									next_button[0].style.visibility='hidden';
								}
								else {
									next_button[0].style.visibility='visible';
								}
						});
				}
				// HANDLE FUTURE EVENTS
				for (var i = 0; i < next_button.length; i++) {
						next_button[i].addEventListener('click', function() {
								current_view+=1;
								if (current_view >= 0) {
									next_button[0].style.visibility='hidden';
								}
								else {
									next_button[0].style.visibility='visible';
								}
						});
				}

				scheduler.config.full_day = true;

				scheduler.config.xml_date="%Y-%m-%d %H:%i";

				// scheduler.skin = "classic"; //valid values are classic, glossy, terrace
				scheduler.skin = "flat"; //valid values are classic, glossy, terrace

				scheduler.config.separate_short_events = true;

				scheduler.config.default_date = "%j %M %Y";

				var formatDateFunc = scheduler.date.date_to_str("%Y-%m-%dT%H:%i:%s");

				// scheduler.config.hour_date=""%h:%i %A"";

				var weekDay = scheduler.date.date_to_str("%D")

				// I think this is where the bug is where the data posting to the view is causing the error for the start and end times
				var updateDayStatus = function(event_id, ev) {

                    start = stringEscape(scheduler.getEvent(event_id).text);

					$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "create_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							start: formatDateFunc(scheduler.getEvent(event_id).start_date),
							end: formatDateFunc(scheduler.getEvent(event_id).end_date),
							text: start,
							id: scheduler.getEvent(event_id).id,
							weekday: weekDay(scheduler.getEvent(event_id).start_date), //what if the event was a multi-day event?!?!
							color: scheduler.getEvent(event_id).color

						},
						success: function() {

							console.log("Got here on success!")
							var targetText = "Event Successfully Generated and Synced!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);
						},

						error: function() {
							console.log("did i get here?1");
							var targetText = "Event Successfully Generated and Synced!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						}

					});
				};

                var update_event = function(id, ev, color) {
                    event_text = stringEscape(ev.text);
                    if(typeof color === 'undefined'){
                        $('.ajaxProgress').show();
        					$.ajax({
        						type: "POST",
        						url: "update_event/",
        						dataType: "json",
        						data: {
        							csrfmiddlewaretoken: '{{ csrf_token }}',
        							start: formatDateFunc(scheduler.getEvent(id).start_date),
        							end: formatDateFunc(scheduler.getEvent(id).end_date),
        							text: event_text,
        							id: id
        						},
						success: function() {

							var targetText = "Event Successfully Updated!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						},

						error: function() {
							var targetText = "Event Successfully Updated!"
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						}
        					});
        		    		return true;
                    }

                    else {

                    $('.ajaxProgress').show();
    					$.ajax({
    						type: "POST",
    						url: "update_event/",
    						dataType: "json",
    						data: {
    							csrfmiddlewaretoken: '{{ csrf_token }}',
    							start: formatDateFunc(scheduler.getEvent(id).start_date),
    							end: formatDateFunc(scheduler.getEvent(id).end_date),
    							text: event_text,
    							id: id,
                                color: color
    						},
						success: function() {

							var targetText = "Event Successfully Updated!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						},

						error: function() {
							var targetText = "Event Successfully Updated!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						}
    					});
    		    		return true;
                    };
                };


				var deleteEvent = function(event_id, e) {
					$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "delete_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							id: event_id
						},

						success: function() {

							var targetText = "Event Successfully Removed!";
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						},

						error: function() {
							var targetText = "Event Successfully Removed!"
							showGoogleSyncFeedback(targetText);
							setTimeout( function() { hideGoogleSyncFeedback();}, 3000);	
						}

					});
					return true;
				};

				// scheduler.config.separate_short_events = true;
				scheduler.config.hour_size_px = 100;
				scheduler.config.scroll_hour = {{user_wakeup_time}};
				scheduler.config.mark_now = true;

                scheduler.config.icons_select = ['icon_details', 'icon_delete', 'i1', 'i2', 'i3', 'i4', 'i5', 'i6', 'i7', 'i8', 'i9', 'i10', 'i11'];

        		scheduler.locale.labels.i1 = "i_1";
        		scheduler.locale.labels.i2 = "i_2";
        		scheduler.locale.labels.i3 = "i_3";
        		scheduler.locale.labels.i4 = "i_4";
                scheduler.locale.labels.i5 = "i_5";
                scheduler.locale.labels.i6 = "i_6";
                scheduler.locale.labels.i7 = "i_7";
                scheduler.locale.labels.i8 = "i_8";
                scheduler.locale.labels.i9 = "i_9";
                scheduler.locale.labels.i10 = "i_10";
                scheduler.locale.labels.i11 = "i_11";

                scheduler._click.buttons.i1 = function(id){
        			scheduler.getEvent(id).color = "#AEA8D3";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#AEA8D3");
        			return "";
        		};

                scheduler._click.buttons.i2 = function(id){
        			scheduler.getEvent(id).color = "#87D37C";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#87D37C");
        			return "";
        		};
                scheduler._click.buttons.i3 = function(id){
        			scheduler.getEvent(id).color = "#BE90D4";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#BE90D4");
        			return "";
        		};

                scheduler._click.buttons.i4 = function(id){
        			scheduler.getEvent(id).color = "#E26A6A";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#E26A6A");
        			return "";
        		};
                scheduler._click.buttons.i5 = function(id){
        			scheduler.getEvent(id).color = "#F9BF3B";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#F9BF3B");
        			return "";
        		};

                scheduler._click.buttons.i6 = function(id){
        			scheduler.getEvent(id).color = "#EB974E";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#EB974E");
        			return "";
        		};
                scheduler._click.buttons.i7 = function(id){
        			scheduler.getEvent(id).color = "#19B5FE";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#19B5FE");
        			return "";
        		};

                scheduler._click.buttons.i8 = function(id){
        			scheduler.getEvent(id).color = "#D2D7D3";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#D2D7D3");
        			return "";
        		};
                scheduler._click.buttons.i9 = function(id){
        			scheduler.getEvent(id).color = "#4B77BE";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#4B77BE");
        			return "";
        		};

                scheduler._click.buttons.i10 = function(id){
        			scheduler.getEvent(id).color = "#26A65B";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#26A65B");
        			return "";
        		};
                scheduler._click.buttons.i11 = function(id){
        			scheduler.getEvent(id).color = "#D24D57";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#D24D57");
        			return "";
        		};

				scheduler.attachEvent("onEventDeleted", deleteEvent);
				scheduler.attachEvent("onClick", readonly_check);
				scheduler.attachEvent("onDblClick", readonly_check);


				// JS event for the onEventAdded function to do an AJAX call to the database for syncing the new event data
				scheduler.attachEvent("onEventAdded", updateDayStatus);


				scheduler.attachEvent("onEventChanged",function(id,ev){
		    		$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "update_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							start: formatDateFunc(scheduler.getEvent(id).start_date),
							end: formatDateFunc(scheduler.getEvent(id).end_date),
							text: ev.text,
							id: id

						},
					});
		    		return true;
				});

				scheduler.attachEvent("onEventChanged", update_event);


				// Create a new date for gatehring the default times that load into the calendar
				var d = new Date();

				//Get an integer value for getting the full year of the current year in the calendar
				var calendar_year = d.getFullYear();

				//Get the current default month to load into the initial view for the calendar
				var calendar_month = d.getMonth();

				//Get the current day for the calendar to load into the default value for the calendar
				var calendar_day = {{user_day_of_week}};


				scheduler.attachEvent("onBeforeDrag", readonly_check);

				scheduler.config.hour_date = "%g:%i%a";
				// scheduler.config.readonly = true;
				scheduler.init('scheduler_here',new Date(calendar_year,calendar_month,calendar_day),"week");

				scheduler.parse( [

						{% for mon_tasks in mon_TASK %}

							{
								text: "{{mon_tasks}}",
								id: '{{ mon_tasks.UID }}',
								start_date: '{{ mon_tasks.start_time }}'.substring(0, 10)+" "+'{{ mon_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ mon_tasks.end_time }}'.substring(0, 10)+" "+'{{ mon_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for tues_tasks in tues_TASK %}

							{
								text: "{{tues_tasks}}",
								id: '{{ tues_tasks.UID }}',
								start_date: '{{ tues_tasks.start_time }}'.substring(0, 10)+" "+'{{ tues_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ tues_tasks.end_time }}'.substring(0, 10)+" "+'{{ tues_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for wed_tasks in wed_TASK %}

							{
								text: "{{wed_tasks}}",
								id: '{{ wed_tasks.UID }}',
								start_date: '{{ wed_tasks.start_time }}'.substring(0, 10)+" "+'{{ wed_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ wed_tasks.end_time }}'.substring(0, 10)+" "+'{{ wed_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for thurs_tasks in thurs_TASK %}

							{
								text: "{{thurs_tasks}}",
								id: '{{ thurs_tasks.UID }}',
								start_date: '{{ thurs_tasks.start_time }}'.substring(0, 10)+" "+'{{ thurs_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ thurs_tasks.end_time }}'.substring(0, 10)+" "+'{{ thurs_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}
						{% for fri_tasks in fri_TASK %}

							{
								text: "{{fri_tasks}}",
								id: '{{ fri_tasks.UID }}',
								start_date: '{{ fri_tasks.start_time }}'.substring(0, 10)+" "+'{{ fri_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ fri_tasks.end_time }}'.substring(0, 10)+" "+'{{ fri_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for sat_tasks in sat_TASK %}

							{
								text: "{{sat_tasks}}",
								id: '{{ sat_tasks.UID }}',
								start_date: '{{ sat_tasks.start_time }}'.substring(0, 10)+" "+'{{ sat_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sat_tasks.end_time }}'.substring(0, 10)+" "+'{{ sat_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for sun_tasks in sun_TASK %}

							{
								text: "{{sun_tasks}}",
								id: '{{ sun_tasks.UID }}',
								start_date: '{{ sun_tasks.start_time }}'.substring(0, 10)+" "+'{{ sun_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sun_tasks.end_time }}'.substring(0, 10)+" "+'{{ sun_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}



						{% for monday_tasks in mon %}
						{% if monday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ monday_tasks.task_name }}',
								id: '{{ monday_tasks.special_event_id }}',
								start_date: '{{ monday_tasks.start_time }}'.substring(0, 10)+" "+'{{ monday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ monday_tasks.end_time }}'.substring(0, 10)+" "+'{{ monday_tasks.end_time }}'.substring(11, 16),
								color: '{{ monday_tasks.color }}'
							},
						{% endif %}
						{% endfor %}
						{% for tuesday_tasks in tues %}
						{% if tuesday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ tuesday_tasks.task_name }}',
								id: '{{ tuesday_tasks.special_event_id }}',
								start_date: '{{ tuesday_tasks.start_time }}'.substring(0, 10)+" "+'{{ tuesday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ tuesday_tasks.end_time }}'.substring(0, 10)+" "+'{{ tuesday_tasks.end_time }}'.substring(11, 16),
								color: '{{ tuesday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for wednesday_tasks in wed %}
						{% if wednesday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ wednesday_tasks.task_name }}',
								id: '{{ wednesday_tasks.special_event_id }}',
								start_date: '{{ wednesday_tasks.start_time }}'.substring(0, 10)+" "+'{{ wednesday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ wednesday_tasks.end_time }}'.substring(0, 10)+" "+'{{ wednesday_tasks.end_time }}'.substring(11, 16),
								color: '{{ wednesday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for thursday_tasks in thurs %}
						{% if thursday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ thursday_tasks.task_name }}',
								id: '{{ thursday_tasks.special_event_id }}',
								start_date: '{{ thursday_tasks.start_time }}'.substring(0, 10)+" "+'{{ thursday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ thursday_tasks.end_time }}'.substring(0, 10)+" "+'{{ thursday_tasks.end_time }}'.substring(11, 16),
								color: '{{ thursday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for friday_tasks in fri %}
						{% if friday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ friday_tasks.task_name }}',
								id: '{{ friday_tasks.special_event_id }}',
								start_date: '{{ friday_tasks.start_time }}'.substring(0, 10)+" "+'{{ friday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ friday_tasks.end_time }}'.substring(0, 10)+" "+'{{ friday_tasks.end_time }}'.substring(11, 16),
								color: '{{ friday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for saturday_tasks in sat %}
						{% if saturday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ saturday_tasks.task_name }}',
								id: '{{ saturday_tasks.special_event_id }}',
								start_date: '{{ saturday_tasks.start_time }}'.substring(0, 10)+" "+'{{ saturday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ saturday_tasks.end_time }}'.substring(0, 10)+" "+'{{ saturday_tasks.end_time }}'.substring(11, 16),
								color: '{{ saturday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for sunday_tasks in sun %}
						{% if sunday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ sunday_tasks.task_name }}',
								id: '{{ sunday_tasks.special_event_id }}',
								start_date: '{{ sunday_tasks.start_time }}'.substring(0, 10)+" "+'{{ sunday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sunday_tasks.end_time }}'.substring(0, 10)+" "+'{{ sunday_tasks.end_time }}'.substring(11, 16),
								color: '{{ sunday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}

				], "json");

				//Array to store all the currently gathered google events for the user on the calendar

				//Storing all the google events to enable ability to make read-only
				{% for monday_tasks in mon %}
						{% if monday_tasks.is_google_task %}
							google_ids.push('{{ monday_tasks.special_event_id }}');
						{% endif %}
				{% endfor %}
				{% for tuesday_tasks in tues %}
					{% if tuesday_tasks.is_google_task %}
						google_ids.push('{{ tuesday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for wednesday_tasks in wed %}
					{% if wednesday_tasks.is_google_task %}
						google_ids.push('{{ wednesday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for thursday_tasks in thurs %}
					{% if thursday_tasks.is_google_task %}
						google_ids.push('{{ thursday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for friday_tasks in fri %}
					{% if friday_tasks.is_google_task %}
						google_ids.push('{{ friday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for saturday_tasks in sat %}
					{% if saturday_tasks.is_google_task %}
						google_ids.push('{{ saturday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for sunday_tasks in sun %}
					{% if sunday_tasks.is_google_task %}
						google_ids.push('{{ sunday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}


				var breakdown_mini_tasks = []

				//Storing all the google events to enable ability to make read-only
				{% for BDMT in breakdown_tasks %}
					breakdown_mini_tasks.push('{{ BDMT.UID }}');
				{% endfor %}



				//Function to deal with making google tasks read only
				function readonly_check(id) {


					var found_google_task = false;
					var found_mini_task = false;

					for (i = 0; i < google_ids.length; i++) {
						if (google_ids[i] == id) {
							found_google_task = true;
						}
					}

					//Search through the breakdown mini tasks
					for (i = 0; i < breakdown_mini_tasks.length; i++) {
						if (breakdown_mini_tasks[i] == id) {
							found_mini_task = true;
						}
					}


					if (found_google_task) {
						var readOnly = scheduler.getEvent(id).readonly;
						scheduler.config.drag_move = true;
						scheduler.config.drag_resize = readOnly;
                        open_modal_google(scheduler.getEvent(id).id, scheduler.getEvent(id).color, formatDateFunc(scheduler.getEvent(id).start_date), formatDateFunc(scheduler.getEvent(id).end_date));
						return false;
					}

					else if (found_mini_task) {
						var readOnly = scheduler.getEvent(id).readonly;
						scheduler.config.drag_move = true;
						scheduler.config.drag_resize = readOnly;
                        open_modal_breakdown_tasks(scheduler.getEvent(id).id, scheduler.getEvent(id).color, formatDateFunc(scheduler.getEvent(id).start_date), formatDateFunc(scheduler.getEvent(id).end_date));
						return false;
					}

					else {9
						return true;
					}
				}

                // The goal is to open a modal window for the google events
                function modal_check_for_google(id) {

                    for (i = 0; i < google_ids.length; i++) {
						if (google_ids[i] == id) {
							found_google_task = true;
						}
					}
					if (found_google_task) {

                        open_modal_google(scheduler.getEvent(id).id, scheduler.getEvent(id).color);
						return false;
					}
                }
			}

			$(function() {
			    $( "#datepicker" ).datepicker({

			      minDate: 0,
			      showAnim: "blind",
			      duration: "slow"

			    });
			});

			
		</script>


		<style type="text/css" media="screen">
			html, body{
				margin:0px;
				padding:0px;
				height:90%;
			}

			.dhx_calendar_click {
				background-color: #C2D5FC !important;
			}

			.pushdown {
				margin-top: 100px;
			}



            @import url(http://fonts.googleapis.com/css?family=Open+Sans:400,700);

            h1 {
              text-align: center;
              font-family: "Open Sans", sans-serif;
              font-size: 22px;
              color: #171717;
              font-weight: 700;
            }
            h1 span {
              font-weight: 400;
            }

            .container {

              min-width: 640px;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-orient: vertical;
              -webkit-box-direction: normal;
              -webkit-flex-direction: column;
                  -ms-flex-direction: column;
                      flex-direction: column;
            }
            .button-container {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-pack: justify;
              -webkit-justify-content: space-between;
                  -ms-flex-pack: justify;
                      justify-content: space-between;
              margin: 60px auto;
            }

            .button {
              border: 0 none;
              border-radius: 36px;
              padding: 5px 55px;
              margin: 0 10px;
              cursor: pointer;
              display: inline-block;
              font-size: 14px;
              color: #fff;
              text-transform: none;
              -webkit-transition: all 80ms ease-in-out;
              transition: all 80ms ease-in-out;
            }
            .button:hover {
              opacity: .7;
            }

            .button.-dark {
              background: #171717;
              color: #FFFFFF;
            }

            .button.-green {
              background: #3AB54A;
              color: #FFFFFF;
            }

            .button.-blue {
              background: #2C96BE;
              color: #FFFFFF;
            }

            .button.-border {
              background: transparent;
              border: 2px solid #2C96BE;
              color: #2C96BE;
            }
            .button.-border:hover {
              border-color: #2C96BE;
              color: #2C96BE;
              opacity: 1;
            }

            #margin-paragraph-from-right {
                margin-right: 20px;
            }

		.dropdown dd, .dropdown dt, .dropdown ul {
			margin: 0px;
			padding: 0px;
			width: 384px;
		}
		.dropdown dd ul li a span:first-child, .dropdown dt a span span:first-child {
			/*background-image: url('http://i.imgur.com/OQiDoZe.png');*/
			background-repeat: no-repeat;
			width: 384px;
			height: 11px;
			display: inline-block;
			margin:0px;
			vertical-align: top;
		}
		.dropdown dt a span {
			width: 384px;
			cursor: pointer;
			display: block;
			padding: 5px;
			white-space: nowrap;
		}
		.dropdown dt a img {
			position: relative;
			z-index: 1;
		}
		.dropdown dt a span span:first-child:before {
			position: absolute;
			content: '';
			width: 15px;
			height: 10px;
			box-shadow: 0 1px 1px rgba(0,0,0,0.2) inset;
		}
		.dropdown dt a span span {
			display: inline-block;
			padding: 0;
		}
		.dropdown dt a span span:first-child {
			padding: 0;
		}
		.dropdown dd {
			position: relative;
		}
		.dropdown a, .dropdown a:visited {
			color: #4a535f;
			text-decoration: none;
			outline: none;
		}
		.dropdown a:hover {
			color: #5d4617;
		}
		.dropdown dt a:hover, .dropdown dt a:focus {
			color: #41A9DA;
			width: 384px;
		}
		.dropdown dt a {
			position: relative;
			background: #e3e6ef;
			display: block;
			padding-right: 20px;
			overflow: hidden;
			border:1px solid #2C3E50;
			width:250px;
		}
		.dropdown dt a:after {
			content: '';
			background: #2C3E50;
			position: absolute;
			
			height: 32px;
		    position: absolute;
		    right: 0;
		    top: 0;
		    width: 35px;
		}

		.dropdown dt a:before {
		    background: none repeat scroll 0 0 #FFFFFF;
		    content: "";
		    height: 3px;
		    position: absolute;
		    right: 7px;
		    top: 6px;
		    width: 20px;
		    z-index: 2;
			box-shadow:0 8px 0 #FFFFFF, 0 16px 0 #FFFFFF;
		}
		.dropdown dd ul {
			background: #f0f2f7;
			
			color: #C5C0B0;
			display: none;
			left: 0px;
			padding: 5px 0px;
			position: absolute;
			
			width: 384px;
			border:1px solid #2C3E50;
			list-style: none;
			max-height: 170px;
			overflow-y: scroll;
			top:10px;
			z-index: 2;
		}

		li a {
			font-size:13px;
		}

		li a span:nth-child(2) {
		    line-height: 2em;
		}
		.dropdown dd ul::-webkit-scrollbar-track {
		 -webkit-box-shadow: inset 0 0 1px rgba(0,0,0,0.3);
		 border-left:1px solid rgba(0,0,0,0.1);
		}
		.dropdown dd ul::-webkit-scrollbar-thumb {
		 background: rgba(0,0,0,0.4);
		/*-webkit-box-shadow: inset 0 0 1px rgba(0,0,0,0.5), 1px 0 0 #5cace9 inset, 2px 0 0 #b3d5ee inset;
		    border-radius:10px;*/
		}
		.dropdown dd ul::-webkit-scrollbar-thumb:window-inactive {
		 background: blue;
		}
		.dropdown span.value {
			display: none;
		}
		.dropdown dd ul li a {
			padding: 5px;
			display: block;
			font-size: 12px !important;
		}
		.dropdown dd ul li a:hover {
			background-color: rgba(0,0,0,0.05);
		}
		dl.dropdown {
			display: inline-block;
			width: 384px;
			margin: -3px 0 0 1px;
		}
		dl.dropdown span:nth-child(3) {
			color: rgba(0,0,0,0.4)
		}
		dl.dropdown > span:nth-child(2) {
			overflow: hidden;
			white-space: nowrap;
			display: inline-block;
		}
		dl.dropdown span:nth-child(3) {
			float: right;
		}
		dl.dropdown dt span:nth-child(2) {
			color: rgba(0, 0, 0, 0.6);
		    font-size: 14px;
		    font-weight: bold;
		    line-height: 1.6em;
		}
		dl.dropdown dt span:nth-child(3) {
			display: none;
		}
		dl {
			background-color: #41A9DA;
			width: 600px;
		}

		.dropdown dt a, .dropdown dt a:focus {
			color: #41A9DA;
			width: 384px;
		}

		.countryFlag {
			padding: 0;
			background-image: url("http://i.imgur.com/OQiDoZe.png");
			background-repeat: no-repeat;
			display: inline-block;
			height: 11px;
			margin-right: 4px;
			width: 16px;
			cursor: pointer;
			white-space: nowrap;
			-moz-border-bottom-colors: none;
			-moz-border-left-colors: none;
			-moz-border-right-colors: none;
			-moz-border-top-colors: none;
			border-color: #BFBFC1 #B6B6B6 #969696;
			border-image: none;
			border-radius: 2px 2px 2px 2px;
			border-style: solid;
			border-width: 1px;
			box-shadow: 0 1px 1px rgba(0, 0, 0, 0.09);
		}


		.wrumper {
			width:383px;
			margin:3% auto;
		}

		</style>
        <style>

            .footer{
                position: absolute;
                left: 0;
                bottom: 0;
                height: 60px;
                width: 100%;
                overflow:hidden;
            }

            /* Paste this css to your style sheet file or under head tag */
            /* This only works with JavaScript,
            if it's not present, don't show loader */
            .no-js #loader { display: none;  }
            .js #loader { display: block; position: absolute; left: 100px; top: 0; }
            .se-pre-con {
            	position: fixed;
            	left: 0px;
            	top: 0px;
            	width: 100%;
            	height: 100%;
            	z-index: 9999;
            	background: url(http://i2.wp.com/smallenvelop.com/wp-content/uploads/2014/08/Preloader_3.gif?zoom=2&resize=64%2C64) center no-repeat #fff;
            }

            #header_text{
                margin-top: 40px;
                font-family: 'Comfortaa', cursive;
                color: #444444;
            }

			/*CSS for collapsing form*/
			#demoTask{
				padding-top: 10px;
			}

		</style>

		<!-- CSS for percent slider -->
		<style>
			#input-select,
			#input-number {
				padding: 7px;
				margin: 15px 5px 5px;
				width: 70px;
			}


			.alert {
			padding: 8px 35px 8px 14px;
			margin-bottom: 18px;
			color: #c09853;
			text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
			background-color: #fcf8e3;
			border: 1px solid #fbeed5;
			-webkit-border-radius: 4px;
			-moz-border-radius: 4px;
			border-radius: 4px;
			visibility: hidden;

			}

			.alert-heading {
			color: inherit;
			}

			.alert .close {
			position: relative;
			top: -2px;
			right: -21px;
			line-height: 18px;
			}

			.alert-success {
			color: #468847;
			background-color: #dff0d8;
			border-color: #d6e9c6;
/*			width: 75%;
			margin: auto;
			margin-top: 50px;
			margin-bottom: 20px;*/
			visibility: hidden;
			}



			a#spaghett{
			  display:block;
			  color:#ad5482;  
			  text-decoration:none;
			  font-weight:bold;
			  margin-top:40px;
			  text-align:center;
			}

			#bg_spaghett{
			  position:relative;
			  height:600px;
			  width:100%;
			  background-size:cover;
			  margin-left:auto;
			  margin-right:auto; 
			  border:#fff 15px solid;
			}

			.module#spaghett{
			  position:relative;
			  /*top:15%;    */
			  height:100%;
			  width:100%;
			  margin:auto;
			  border-radius:0px;
			  background:RGBA(255,255,255,1);
			    
			  -webkit-box-shadow:  0px 0px 2px 0px rgba(0, 0, 0, .45);        
			  box-shadow:  0px 0px 100px 0px rgba(0, 0, 0, .15);
			  
			}

			.module ul#spaghett{
			  list-style-type:none;
			  margin:0;
			}

			.tab#spaghett{
			  float:left;
			  height:60px;
			  width:25%;
			  padding-top:20px;
			  box-sizing:border-box;
			  background:#eeeeee;  
			  text-align:center;
			  cursor:pointer;
			  transition:background .4s;
			}

			.tab:first-child#spaghett{  
			  -webkit-border-radius: 5px 0px 0px 0px;
			  border-radius: 5px 0px 0px 0px;
			}

			.tab:last-child#spaghett{  
			  -webkit-border-radius: 0px 5px 0px 0px;
			  border-radius: 0px 5px 0px 0px;
			}

			.tab:hover#spaghett{  
			  background-color:rgba(0,0,0,.1);
			}

			.activeTab#spaghett{
			  background:#fff;
			}

			.activeTab .icon#spaghett{
			  opacity:1;
			}

			.icon#spaghett{
			  height:24px;
			  width:24px;
			  opacity:.2;
			}

			.form#spaghett{
			  float:left;
			  height:86%;
			  width:100%;
			  box-sizing:border-box;
			  padding:40px;
			}

			.textbox#spaghett{
			  height:50px;
			  width:100%;
			  border-radius:3px;
			  border:rgba(0,0,0,.3) 2px solid;
			  box-sizing:border-box;
			  padding:10px;
			  margin-bottom:30px;
			}

			.textbox:focus#spaghett{
			  outline:none;
			   border:rgba(24,149,215,1) 2px solid;
			   color:rgba(24,149,215,1);
			}

			.button#spaghett{
			  height:50px;
			  width:100%;
			  border-radius:3px;
			  border:rgba(0,0,0,.3) 0px solid;
			  box-sizing:border-box;
			  padding:10px;
			  margin-bottom:30px;
			  background:#90c843;
			  color:#FFF;
			  font-weight:bold;
			  font-size: 12pt;
			  transition:background .4s;
			  margin: auto;
			  cursor:pointer;
			}

			.button:hover#spaghett{
			  background:#80b438;
			  
			}


			#button_width {
				width: 100%;
			}

			#dropdown_width {
				width: 100%;
				margin-bottom: 15px;
				margin-top: -5px;
			}


			input[type="checkbox"] {
			    display:none
			}
			ul li.review {
			    list-style:none;
			    margin:10px auto;
			    font-family:'Lato';
			    position:relative;

			}
			 
			ul li.review:after {
			    content:'';
			    position:absolute;
			    width:35px;
			    height:35px;
			    border:4px solid #fff;
			    border-radius:6px;
			    left:-12px;
			    z-index:-1
			}


			label.review {
			    cursor:pointer;
			    color:#c0392b;
			    margin:5px 0;
			    padding-left:40px;
			    position:relative;
			    font-size:30px;
			    -webkit-transition:.2s linear;
			    -moz-transition:.2s linear;
			    -o-transition:.2s linear;
			    transition:.2s linear
			}


			label.review:before,label.review:after {
			    content:'';
			    left:11px;
			    width:3px;
			    bottom:0;
			    background:#2E4E71;
			    position:absolute;
			    top:0
			}


			label.review:before {
			    transform:rotate(45deg);
			    transform-origin:0 14px;
			    height:0;
			    -webkit-transition:.2s linear;
			    -moz-transition:.2s linear;
			    -o-transition:.2s linear;
			    transition:.2s linear
			}
			 
			label.review:after {
			    transform:rotate(-45deg);
			    transform-origin:0 20px;
			    height:0;
			    -webkit-transition:.2s linear .2s;
			    -moz-transition:.2s linear .2s;
			    -o-transition:.2s linear .2s;
			    transition:.2s linear .2s
			}

			input[type="checkbox"].review:checked + label.review:after,input[type="checkbox"].review:checked + label.review:before {
			    height:100%
			}
			 
			input[type="checkbox"].review:checked + label.review {
			    color:#000;
			    text-decoration: line-through;
			}


		</style>





            <link href='https://fonts.googleapis.com/css?family=Comfortaa:700' rel='stylesheet' type='text/css'>
        <script>

        //paste this code under head tag or in a seperate js file.
        	// Wait for window load
        	$(window).load(function() {
        		// Animate loader off screen
        		$(".se-pre-con").fadeOut("slow");;
        	});

        </script>
</head>
<body onload="init(); check_for_review_AJAX();">

<div class="wrapper">
    <div class="sidebar" data-color="azure" data-image="{% static 'img/DASHBOARD_IMAGES/sidebar-4.jpg' %}">

    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="/dashboard" class="simple-text">
                    Architasker
                    <h6>Welcome back, {{first_name}}!</h6>

                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="/dashboard">
                        <i class="pe-7s-news-paper"></i>
                        <p>Dashboard</p>
                    </a>
                </li>

                <li data-toggle="modal" data-target="#addEventModal">
                    <a href="#">
                        <i class="pe-7s-note"></i>
                        <p>Add Event</p>
                    </a>
                </li>

                <li>
                    <a href="/dashboard">
                        <i class="pe-7s-plus"></i>
                        <p>Add Task</p>
                    </a>
                </li>

                <li>
                    <a href="/settings">
                        <i class="pe-7s-user"></i>
                        <p>Your Account</p>
                    </a>
                </li>


                <li>
                    <a href="#">
                        <i class="pe-7s-bell"></i>
                        <p>Notifications</p>
                    </a>
                </li>



                <li>
                    <a href="#">
                        <i class="pe-7s-help1"></i>
                        <p>Help &amp; Information</p>
                    </a>
                </li>


            </ul>
    	</div>
    </div>





    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Dashboard</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-left">
                        <li>
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-dashboard"></i>
                            </a>
                        </li>

                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                           <a href="">
                               Account
                            </a>
                        </li>

                        <li>
                            <a href="/logout">
                                Log out
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

				{% if user_initial_setup == True %}



                {% if google_auth_complete == True %}


                <!-- DIV onclick may not be good practice tbqh -->
                <div onclick="syncGoogleCalendar();" class='button -border center' id = "syncGoogle" style="float: right;">Sync Google Calendar</div>



                {% else %}
                <p align="right" id="margin-paragraph-from-right"><a href="/oauth" style="text-align: right">Want To Sync With Google Calendar? Click Here</a></p>
                {% endif %}

				<div class="morph-button morph-button-modal morph-button-modal-1 morph-button-fixed" style="float: left;">
						<button type="button">Add Task</button>
						<div class="morph-content">
							<div>
								<div class="content-style-form content-style-form-1">
									<span class="icon icon-close"></span>
									<section id="advanced-form">
									    <form id="example-advanced-form" action="#">
										    <h3>Task</h3>
										    <section>
										        <legend>Task Information</legend>
										 
										        <label for="taskName-2">Task name *</label>
										        <input id="taskName-2" name="taskName" type="text" class="required">
										        <label for="datepicker">Due Date *</label>
										        <!-- <input id="dueDate-2" name="dueDate" type="text" class="required"> -->
										        <input type="text" id="datepicker" name="dueDate" class="required">

											    <label for="location">Location</label>

											    <div id="locationField">
										      	<input id="autocomplete" name="autocomplete" placeholder="Enter your address"
										             onFocus="geolocate()" type="text"></input>
										    	</div>


												<br><br>
												<div class="wrumper">
												<dl id="country-select" class="dropdown">
												  <dt><a href="javascript:void(0);"><span>Select Transit Mode</span></a></dt>
												  <dd>
												    <ul style="display: none;">
												      <li><a href="javascript:void(0);" onclick=fill_transit('0');><img src="http://i.imgur.com/Ck4NVPl.png"><span style="background-position:0px -1694px"></span><span>Driving</span></a></li>
												      <li><a href="javascript:void(0);" onclick=fill_transit('1');><img src="http://i.imgur.com/mDRDTU7.png"><span style="background-position:0px -1694px"></span><span>Bicycling</span></a></li>
												      <li><a href="javascript:void(0);" onclick=fill_transit('2');><img src="http://i.imgur.com/dEeQtBH.png"><span style="background-position:0px -1694px"></span><span>Walking</span></a></li>
												    </ul>

												  </dd>
												</dl>
												</div>

										    </section>
										 
										    <h3>Details</h3>
										    <section>
										    	<legend>Estimated Time &amp; Priority</legend>
										    	<div>
											    	<label for="percent-2">
											    		Complete <div id="valueOfSlider" style='display:inline-block;'></div> by 
											    		
											    		<select id="task_day_of_week">
											    			<option value="Monday">Monday</option>
											    			<option value="Tuesday">Tuesday</option>
											    			<option value="Wednesday">Wednesday</option>
											    			<option value="Thursday">Thursday</option>
											    			<option value="Friday">Friday</option>
											    			<option value="Saturday">Saturday</option>
											    			<option value="Sunday" selected>Sunday</option>
											    		</select>

											    	</label>
											        <!-- <input id="percent-2" name="percent" type="text" class="required"> -->
											        <div>
												        <input type="number" min="0" max="100" step="1" id="input-number" style='display:inline-block;'>
														<div id="html5" style='width:35%; display:inline-block;'></div>
													</div>
												</div>

												<div style='padding-top: 20px'>
											        <label for="task_time">Estimated time (hours) to complete entire task*</label>
											        <input id="task_time" name="task_time" type="text" class="required">
											    </div>

											    <input id="continuous-2" name="continuous" type="checkbox"> 
										        <label for="continuous-2">No-break continuous task</label>

											    <div style='padding-top: 20px'>
													<label for="radiosSlider">Priority *</label>
					      							<div id="radiosSlider"  style='width:350%'>
													    <input id="value1" name="values" type="radio" value="1">
													    <label for="value1">1</label>

													    <input id="value2" name="values" type="radio" value="2">
													    <label for="value2">2</label>

													    <input id="value3" name="values" type="radio" value="3">
													    <label for="value3">3</label>

													    <input id="value4" name="values" type="radio" value="4">
													    <label for="value4">4</label>

													    <input id="value5" name="values" type="radio" value="5" checked>
													    <label for="value5">5</label>

													    <input id="value6" name="values" type="radio" value="6">
													    <label for="value6">6</label>

													    <input id="value7" name="values" type="radio" value="7">
													    <label for="value7">7</label>

													    <input id="value8" name="values" type="radio" value="8">
													    <label for="value8">8</label>

													    <input id="value9" name="values" type="radio" value="9">
													    <label for="value9">9</label>

													    <input id="value10" name="values" type="radio" value="10">
													    <label for="value10">10</label>
													</div>
												</div>
												
										    </section>
										 
										    <h3>Extras</h3>
										    <section>
										        <legend>Extra Integrations</legend>
										 		<div>
											        <input id="pomodoro-2" name="pomodoro" type="checkbox"> 
											        <label for="pomodoro-2">Pomodoro Timer</label>
											    </div>

											    <label for="url">URL</label>
											    <input id="url" name="url" type="text" placeholder="(Optional)">

											    <label for="comment">Extras/Comments/Description:</label>
											    <textarea name="comment" id="comment" placeholder="(Optional)"></textarea>
										    </section>
										</form>
								   	</section>
								</div>
							</div>
						</div>
					</div><!-- morph-button -->

					
					<div class="alert alert-success" visible=false>Success! <span id="updateType"></span></div>

			
				<div id="scheduler_here" class="dhx_cal_container card col-md-12" style='width:100%; height:70%'>

					 <div class="dhx_cal_navline">
							<div class="dhx_cal_prev_button">&nbsp;</div>
							<div class="dhx_cal_next_button">&nbsp;</div>
							<div class="dhx_cal_today_button"></div>
							<div class="dhx_cal_date"></div>
							<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div>
							<div class="dhx_cal_tab rounding_week_tab" name="week_tab" style="right:140px; border-top-right-radius: 5px; border-bottom-right-radius: 5px;"></div>
					 </div>
					 <div class="dhx_cal_header">
					 </div>
					 <div class="dhx_cal_data pushdown">
					 </div>
				</div>

				{% else %}

				<iframe id="encoder_iframe" height=75% width="100%" src="{% url 'screen_setup_module' %}"></iframe>

				{% endif %}


        <footer id="footerID" class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>
                        <li>
                            <a href="#">
                                Home
                            </a>
                        </li>
                        <li>
                            <a href="https://architasker.wordpress.com/">
                               Blog
                            </a>
                        </li>
                    </ul>
                </nav>
                <p class="copyright pull-right">
                    &copy; 2015 <a href="http://www.creative-tim.com">Architasker</a>, made with love for a better scheduler
                </p>
            </div>
        </footer>
        <input type="hidden" id="hidden_transit"></input>

    </div>
</div>
<div class="modal fade" id = "mymodal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="modal_title">Google Event Name: </h4>
      </div>
      <div class="modal-body">
         <p id="start_time"></p>
         <p id="end_time"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<div class="modal fade" id = "reviewal_modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>


        <h4 class="modal-title" id="modal_title">Review Your Productivity: </h4>
      </div>
      <div class="modal-body">
      	<ul id="item_date">
      		
      		<span id="insert_review_here"></span>
      	</ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<script>
		//-----------MORPHING BUTTON/MODAL WINDOW JS---------------------------------
		var docElem = window.document.documentElement, didScroll, scrollPosition;

				// trick to prevent scrolling when opening/closing button
				function noScrollFn() {
					window.scrollTo( scrollPosition ? scrollPosition.x : 0, scrollPosition ? scrollPosition.y : 0 );
				}

				function noScroll() {
					window.removeEventListener( 'scroll', scrollHandler );
					window.addEventListener( 'scroll', noScrollFn );
				}

				function scrollFn() {
					window.addEventListener( 'scroll', scrollHandler );
				}

				function canScroll() {
					window.removeEventListener( 'scroll', noScrollFn );
					scrollFn();
				}

				function scrollHandler() {
					if( !didScroll ) {
						didScroll = true;
						setTimeout( function() { scrollPage(); }, 60 );
					}
				};

				function scrollPage() {
					scrollPosition = { x : window.pageXOffset || docElem.scrollLeft, y : window.pageYOffset || docElem.scrollTop };
					didScroll = false;
				};

				scrollFn();

				var UIBtnn = new UIMorphingButton( document.querySelector( '.morph-button' ), {
					closeEl : '.icon-close',
					onBeforeOpen : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterOpen : function() {
						// can scroll again
						canScroll();
						// form.find(".body:eq(" + 0 + ") label.error").remove();
      //               	form.find(".body:eq(" + 0 + ") .error").removeClass("error");
      //               	form.steps("setStep", 0);
					},
					onBeforeClose : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterClose : function() {
						// can scroll again
						canScroll();
						//resetTaskForm();
					}
				} );

		// -----------FORM STUFF WITHIN MODAL WINDOW----------------------
        var form = $("#example-advanced-form").show();

        form.steps({
            headerTag: "h3",
            bodyTag: "section",
            transitionEffect: "slideLeft",
            enableCancelButton: true,
            onStepChanging: function (event, currentIndex, newIndex)
            {

                

                // Allways allow previous action even if the current form is not valid!
                if (currentIndex > newIndex)
                {
                    return true;
                }
                // Forbid next action on "Warning" step if the user is to young
                if (newIndex === 3 && Number($("#age-2").val()) < 18)
                {
                    return false;
                }
                // Needed in some cases if the user went back (clean up)
                if (currentIndex < newIndex)
                {
                    // To remove error styles
                    form.find(".body:eq(" + newIndex + ") label.error").remove();
                    form.find(".body:eq(" + newIndex + ") .error").removeClass("error");
                }
                form.validate().settings.ignore = ":disabled,:hidden";
                return form.valid();
            },
            onStepChanged: function (event, currentIndex, priorIndex)
            {
                // Used to skip the "Warning" step if the user is old enough.
                if (currentIndex === 2 && Number($("#age-2").val()) >= 18)
                {
                    form.steps("next");
                }
                // Used to skip the "Warning" step if the user is old enough and wants to the previous step.
                if (currentIndex === 2 && priorIndex === 3)
                {
                    form.steps("previous");
                }

                if (currentIndex === 1)
                {
                	console.log(Date.parse('next sunday'));
                    if(Date.parse(document.getElementById("datepicker").value) < Date.parse('next sunday'))
                    {
                    	var task_day = Date.parse(document.getElementById("datepicker").value).toString("dddd");
                    	document.getElementById('task_day_of_week').value = task_day;
                    	document.getElementById("html5").noUiSlider.set(100);
                    	console.log(task_day);
                    }
                }
            },
            onCanceled: function (event) 
            { 
            	resetTaskForm();
            	form.find(".body:eq(" + 0 + ") label.error").remove();
                form.find(".body:eq(" + 0 + ") .error").removeClass("error");
            },
            onFinishing: function (event, currentIndex)
            {
                form.validate().settings.ignore = ":disabled";
                return form.valid();
            },
            onFinished: function (event, currentIndex)
            {
                // alert("Submitted!");

                var url = location_of_task = comment = "None";
                if (!(document.getElementById("url").value === "")) {
                	console.log("Inside url if statement");
                	url = document.getElementById("url").value;
                }

                if (!(document.getElementById("autocomplete").value === "")) {
                	location_of_task = document.getElementById("autocomplete").value;
                }

                if (!(document.getElementById("comment").value === "")) {
                	comment = document.getElementById("comment").value;
                }

                var task_day_date = Date.parse("next" + document.getElementById('task_day_of_week').value);
                var mm = task_day_date.getMonth()+1;
                var dd = task_day_date.getDate();
                var yyyy = task_day_date.getFullYear();

                if(dd<10) {
    				dd='0'+dd;
				} 

				if(mm<10) {
    				mm='0'+mm;
				} 

				task_day_date = yyyy+'-'+mm+'-'+dd;

                console.log("Task name:" + document.getElementById("taskName-2").value);
                console.log("Date:" + document.getElementById("datepicker").value);
                console.log("Percent:" + document.getElementById("input-number").value);
                console.log("Hours:" + document.getElementById("task_time").value);
                console.log("Priority:" + $('input[name="values"]:checked').val());
                console.log("Continuous:" + document.getElementById("continuous-2").checked);
                console.log("Pomodoro:" + document.getElementById("pomodoro-2").checked);
                console.log("Url:" + url);
                console.log("Location:" + location_of_task);
                console.log("Comment:" + comment);
                console.log(Date.parse("next" + document.getElementById('task_day_of_week').value));

                var succeed = false;

                $('.ajaxProgress').show();
				$.ajax({
					type: "POST",
					url: "create_task/",
					dataType: "json",
					data: {
						csrfmiddlewaretoken: '{{ csrf_token }}',
						task_name: document.getElementById("taskName-2").value,
						task_due_date: document.getElementById("datepicker").value,
						task_percent: document.getElementById("input-number").value,
						task_time: document.getElementById("task_time").value,
						task_priority: $('input[name="values"]:checked').val(),
						task_continuous: document.getElementById("continuous-2").checked,
						task_pomodoro: document.getElementById("pomodoro-2").checked,
						task_url: url,
						task_location: document.getElementById("autocomplete").value,
						task_comments: comment,
						task_day_date: task_day_date,
						task_day_num: Date.getDayNumberFromName(document.getElementById('task_day_of_week').value),
						task_transit_mode: document.getElementById("hidden_transit").text
					},
					success: function(json) {

						if (json['conflict_bool'] == 1) {
							succeed = true;
							console.log(json)

							var needed_available_hours = parseFloat(json['needed_available_hours']);
							var available_hours = parseFloat(json['available_hours']);

							var lower_hours = needed_available_hours - available_hours;
							lower_hours = lower_hours.toFixed(2);

							console.log("The task " + json['task_name'] + " has a conflict.");
							console.log("You need " + json['needed_available_hours'] + " hours, but only have " + json['available_hours'] + " hours");
							console.log("This task is only possible if you decrease the required hours by "  + lower_hours);

							$('#conf_task_name').text(json['task_name']);
							$('#conf_hours_needed').text(json['needed_available_hours']);
							$('#conf_current_avail_hours').text(json['available_hours']);
							$('#conf_decrease_by').text(lower_hours);

							$('#taskconflictmodal').modal('show');



						}
						else {

							console.log("there is no conflict!");
							location.href = "/dashboard";
						}
					},

					error: function() {

						console.log("did i get here?");
						// location.href = "/dashboard";
					}


				});
				
				UIBtnn.toggle();

				resetTaskForm();


				return succeed;



            }
        }).validate({
            errorPlacement: function errorPlacement(error, element) { element.before(error); },
            rules: {
                task_time: {
                    number: true
                }
            }
        });

        $(document).ready( function(){
        	$("#radiosSlider").radiosToSlider();
    	});

    	function resetTaskForm() {
			document.getElementById("taskName-2").value = "";
				document.getElementById("datepicker").value = "";
				document.getElementById("input-number").value = "";
				document.getElementById("task_time").value = "";
				document.getElementById("continuous-2").checked = false;
				document.getElementById("pomodoro-2").checked = false;
				document.getElementById("url").value = "";
				document.getElementById("location").value = "";
				document.getElementById("comment").value = "";
				document.getElementById("html5").noUiSlider.set(50);
				document.getElementById('task_day_of_week').value = "Sunday";
				// document.getElementById("value5").checked = true;
				// var $radios = $('input:radio[name=values]');
				// $radios.filter('[value=5]').prop('checked', true);
				$("input[name=values][value=" + 5 + "]").prop('checked', true);
				// $("#task_day_of_week").val("Sunday");
				// $("#task_day_of_week").selectmenu('refresh');
				// $('input:radio[name=values]').val("5");

				form.steps("reset");
		};

    </script>

    <!-- Javascript for percent slider -->
    <script>
		var html5Slider = document.getElementById('html5');

		noUiSlider.create(html5Slider, {
			start: 50,
			connect: "lower",
			step: 1,
			range: {
				'min': 0,
				'max': 100
			}
		});

		var inputNumber = document.getElementById('input-number');
		var valueOfSlider = document.getElementById('valueOfSlider');

		html5Slider.noUiSlider.on('update', function( values, handle ) {

			var value = values[handle];
			inputNumber.value = Math.round(value);
			valueOfSlider.innerHTML = Math.round(value) + "%";
		});


		inputNumber.addEventListener('change', function(){
			html5Slider.noUiSlider.set([this.value]);
		});
	</script>


    <!-- <script src="http://senthilraj.github.io/TimePicki/js/jquery.min.js"></script> -->
    <script src="http://senthilraj.github.io/TimePicki/js/timepicki.js"></script>


</body>
<div class="se-pre-con"></div>

<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script> -->

<!--   Core JS Files   -->
<!-- <script src="{% static 'js/DASHBOARD_JAVASCRIPT/jquery-1.10.2.js'%}" type="text/javascript"></script> -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap.min.js' %}" type="text/javascript"></script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBV1nboJgNwEtCcsowDe9f6bf4WGZaj7ao&signed_in=true&libraries=places&callback=initAutocomplete"
        async defer></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap-checkbox-radio-switch.js' %}"></script>

<!--  Charts Plugin -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/chartist.min.js' %}"></script>

<!--  Notifications Plugin    -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap-notify.js' %}"></script>

  <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/light-bootstrap-dashboard.js' %}"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/demo.js' %}"></script>

	<script type="text/javascript">
			{% if user_initial_setup == False %}
    	$(document).ready(function(){
        	$.notify({
            	icon: 'pe-7s-bell',
            	message: "Welcome to Architasker! Get started by setting up your account so we can begin adding tasks."

            },{
                type: 'info',
                timer: -1
            });
    	});

        {% if google_auth_complete %}

        setTimeout(function(){  }, 500);
            //If the user has already authorize timezone and OAUTH2
            $('#encoder_iframe').load(function(){

                    //Grab the inner iFrame
                    var iframe = $('#encoder_iframe').contents();

                    //Click the initial next button
                    iframe.find("#next").click();

                    //Set timeout for load and then next again for the final set
                    setTimeout(function(){ iframe.find("#next_again").click(); }, 1000);

            });

        {% endif %}


		{% endif %}


 function setCountry(code){
        if(code || code==''){
            var text = jQuery('a[cunt_code="'+code+'"]').html();
            $(".dropdown dt a span").html(text);
        }
    }
    $(document).ready(function() {
        $(".dropdown img.flag").addClass("flagvisibility");

        $(".dropdown dt a").click(function() {
            $(".dropdown dd ul").toggle();
        });

        $(".dropdown dd ul li a").click(function() {
            //console.log($(this).html())
            var text = $(this).html();
            $(".dropdown dt a span").html(text);
            $(".dropdown dd ul").hide();
            $("#result").html("Selected value is: " + getSelectedValue("country-select"));
        });

        function getSelectedValue(id) {
            //console.log(id,$("#" + id).find("dt a span.value").html())
            return $("#" + id).find("dt a span.value").html();
        }

        $(document).bind('click', function(e) {
            var $clicked = $(e.target);
            if (! $clicked.parents().hasClass("dropdown"))
                $(".dropdown dd ul").hide();
        });


        $("#flagSwitcher").click(function() {
            $(".dropdown img.flag").toggleClass("flagvisibility");
        });
    });



var placeSearch, autocomplete;
var componentForm = {
  street_number: 'short_name',
  route: 'long_name',
  locality: 'long_name',
  administrative_area_level_1: 'short_name',
  country: 'long_name',
  postal_code: 'short_name'
};

function initAutocomplete() {
  // Create the autocomplete object, restricting the search to geographical
  // location types.
  autocomplete = new google.maps.places.Autocomplete(
      /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
      {types: ['geocode']});

  // When the user selects an address from the dropdown, populate the address
  // fields in the form.
  autocomplete.addListener('place_changed', fillInAddress);
}

function fillInAddress() {
  // Get the place details from the autocomplete object.
  var place = autocomplete.getPlace();

  for (var component in componentForm) {
    document.getElementById(component).value = '';
    document.getElementById(component).disabled = false;
  }

  // Get each component of the address from the place details
  // and fill the corresponding field on the form.
  for (var i = 0; i < place.address_components.length; i++) {
    var addressType = place.address_components[i].types[0];
    if (componentForm[addressType]) {
      var val = place.address_components[i][componentForm[addressType]];
      document.getElementById(addressType).value = val;
    }
  }
}

// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
}

function fill_transit(trans_type) {

	trans_text = document.getElementById("hidden_transit");
	trans_text.text = trans_type;
}

	</script>




<!-- Modal -->
<div id="addEventModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add Customized Event</h4>
      </div>
      <div class="modal-body">



		<div id="bg_spaghett">
		  <div class="module" id="spaghett">
		    
		    <form class="form" id="spaghett">
		    <tr>
			    <td id=""><label for='name'>Event Name:</label></td>
			    <td>
			    	<input type="text" id="spaghett" placeholder="Insert Event Name Here..." class="textbox event_name_text" />
			    </td>
		    </tr>

		    <tr>
			    <td id="pull_me_up"><label for='name'>Event Day Due:</label></td>
			    <td>
					<div class="dropdown" id="dropdown_width">
					  <button class="btn dropdown-toggle" id="button_width" type="button" data-toggle="dropdown"><span id ="replacement_day">Select Day Due</span>
					  <span class="caret"></span></button>
					  <ul class="dropdown-menu">
					    <li onclick="changeDayVal('Monday');" id="day_lab"><a href="#">Monday</a></li>
					    <li onclick="changeDayVal('Tuesday');" id="day_lab"><a href="#">Tuesday</a></li>
					    <li onclick="changeDayVal('Wednesday');" id="day_lab"><a href="#">Wednesday</a></li>
					    <li onclick="changeDayVal('Thursday');" id="day_lab"><a href="#">Thursday</a></li>
					    <li onclick="changeDayVal('Friday');" id="day_lab"><a href="#">Friday</a></li>
					    <li onclick="changeDayVal('Saturday');" id="day_lab"><a href="#">Saturday</a></li>
					    <li onclick="changeDayVal('Sunday');" id="day_lab"><a href="#">Sunday</a></li>
					  </ul>
					</div> 

			    </td>

		    </tr><br>

		    <tr>
			    <td id=""><label for='name'>Start Time:</label></td>
			    <td>
			    	<input type="text" id="spaghett" placeholder="Insert the start time..." class="textbox starter_time" />
			    </td>
		    </tr>

		    <tr>
			    <td id=""><label for='name'>End Time:</label></td>
			    <td>
			    	<input type="text" id="spaghett" placeholder="Insert the end time..." class="textbox ender_time" />
			    </td>
		    </tr>


		    <tr>
			    <td id=""><label for='name'>Event Color:</label></td><br>
			    <td>
			    	<input type='text' id="custom" />
			    </td>
		    </tr>
		    <br>
		    
		      <!-- <input type='text' id= "spaghett" id="custom" /> -->
		      <input type="button" onclick="checkEventConflictAnalysis();" id="spaghett" value="Add Event" class="button" />
		    </form>
		  </div>
		</div>



      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>



<div class="modal fade" id="conflictmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Hold on! There are event and task conflicts!</h4>
      </div>
      <div class="modal-body">


        The event <b><span id="event_name_list_1"></p></b> conflicts with the following tasks:<br>
        <ul id = "event_name_list">

        </ul>
      </div>
      <div class="modal-footer">
      	<button onclick="add_event_and_reallocate()" type="button" class="btn btn-default" data-dismiss="modal">Add and Re-Allocate</button>
      	<button onclick="ajaxAddEventCaller()" type="button" class="btn btn-default" data-dismiss="modal">Add Overlap</button>
        <button onclick="refresher()" type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="taskconflictmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Hold on! There are Task Allocation Conflicts!</h4>
      </div>
      <div class="modal-body">
        Conflicting Task: <b><span id="conf_task_name"></span><br></b>
        Hours Needed For Task: <b><span id="conf_hours_needed"></span><br></b>
        Current Available Hours: <b><span id="conf_current_avail_hours"></span><br></b>
        Decrease Your Task Hours By: <b><span id="conf_decrease_by"></span><br></b>

      </div>
      <div class="modal-footer">
        <button onclick="refresher()" type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>


    <script>
		$('#timepicker1').timepicki();
		$('#timepicker2').timepicki();
    </script>

    <script>
$("#custom").spectrum({
    showPaletteOnly: true,
    togglePaletteOnly: true,
    togglePaletteMoreText: 'more',
    togglePaletteLessText: 'less',
    color: '##3498db',
    palette: [

    	["#1abc9c", "#2ecc71", "#3498db", "#9b59b6", "#34495e", "#16a085", "#27ae60", "#2980b9"],
    	["#8e44ad", "#2c3e50", "#f1c40f", "#e67e22", "#e74c3c", "#ecf0f1", "#95a5a6", "#f39c12"],
    	["#d35400", "#bdc3c7", "#7D1424", "#4CD4B0", "#462446", "#B05F6D", "#47B39D", "#0E9AA7"]


    ]
});



	</script>

<script>
	function myFunction() {
		var color_val = $("#custom").spectrum('get').toHexString();
		return color_val;   
	}

	function getWeekDay() {
		var weekDay = $('#replacement_day').text();
		return weekDay;
	}

	function getEventName() {
		var eventName = $('.event_name_text').val();
		return eventName;
	}

	function getStartEndTimes() {

		var startTime = $('.starter_time').val();
		var endTime = $('.ender_time').val();

		var totalTimes = [startTime, endTime];
		return totalTimes;
	}


	function setWeekDay() {
		$('#replacement_day').val('');
	}

	function setEventName() {
		$('.event_name_text').val('');
	}

	function setStartEndTimes() {

		$('.starter_time').val('0:00:00');
		$('.ender_time').val('0:00:00');

	}
	
		function create_new_event_form() {

		    var hex_color = myFunction();
		    var weekDay = getWeekDay();
		    var eventName = getEventName();
		    var allTimes = getStartEndTimes();

		    console.log(hex_color);
		    console.log(weekDay);
		    console.log(eventName);
		    console.log(allTimes);

		    $.ajax({
		        url : "create_event/", // the endpoint
		        type : "POST", // http method
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					start: allTimes[0],
					end: allTimes[1],
					text: eventName,
					id: "123123",
					current_day: weekDay, //what if the event was a multi-day event?!?!
					color: hex_color

				},
		        success : function(json) {

		            console.log("success"); // another sanity check
		            location.href = "/dashboard";
		        },

		        // handle a non-successful response
		        error : function(xhr,errmsg,err) {
		        	console.log("didn't work");
		        }
		    });
		};


		function add_event_and_reallocate() {

		    var hex_color = myFunction();
		    var weekDay = getWeekDay();
		    var eventName = getEventName();
		    var allTimes = getStartEndTimes();

		    console.log(hex_color);
		    console.log(weekDay);
		    console.log(eventName);
		    console.log(allTimes);

		    $.ajax({
		        url : "create_event/", // the endpoint
		        type : "POST", // http method
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					start: allTimes[0],
					end: allTimes[1],
					text: eventName,
					id: "123123",
					current_day: weekDay, //what if the event was a multi-day event?!?!
					color: hex_color

				},
		        success : function(json) {

		            console.log("success"); // another sanity check
		            run_allocate_test();
		            location.href = "/dashboard";
		            
		        },

		        // handle a non-successful response
		        error : function(xhr,errmsg,err) {
		        	console.log("didn't work");
		        }
		    });
		};


		function run_allocate_test() {

		    $.ajax({
		        url : "allocate_test/", // the endpoint
		        type : "POST", // http method
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',

				},
		        success : function() {

		            console.log("success"); // another sanity check
		            
		        },

		        // handle a non-successful response
		        error : function(xhr,errmsg,err) {
		        	console.log("didn't work allocate test");
		        }
		    });
		};




		//This is an ajax call that will help display event and mini task conflict analysis in modal
		function checkEventConflictAnalysis() {

			//Get an array of the start and end times for the event
			var allTimes = getStartEndTimes();

			//Get the week day to pass into the backend for proper conversion
			var weekDay = getWeekDay();

			//Ajax call into the backend
			$('.ajaxProgress').show();
			$.ajax({
				type: "POST",
				url: "event_conflict/",
				dataType: "json",
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
					start: allTimes[0],
					end: allTimes[1],
					current_day: weekDay,
				},
		        success : function(my_json) {

		        	//Auto hide the modal window for add-event
		            $('#addEventModal').modal('hide');

		            var count = Object.keys(my_json).length;

		            if (count > 0) {

		            	//Count represents the number of json objects returned in the dump from the backend
		            	console.log("There are " + count + " conflicts");

		            	//Get the event name with conflicts
		            	var eventName = getEventName();

		            	//Set the html of the conflict analysis modal window with the event name
		            	event_name_HTML = document.getElementById("event_name_list_1");
		            	event_name_HTML.innerHTML = eventName;

		            	//Set the list by looping through JSON elements
		            	conflict_list_HTML = document.getElementById("event_name_list");

		            	//Loop through each conflict and append it to the html list
		            	//RIGHT HERE WE NEED TO ENSURE TO ADD TIMES AS WELL TO BE MORE EXPLANATORY WITH THE ERROR MESSAGES
						for (i = 0; i < count; i++) {
						    conflict_list_HTML.innerHTML += "<li>" + my_json[i]['fields']['bdt_name'] +"</li>";
						}
						//Show all the conflicts within the modal window
		            	$('#conflictmodal').modal('show');
		          
		            	
		        	}
		        	else {
		        		console.log("There are no conflicts!");
		        		event_can_add = true;
		  
		        	}
		        },

		        // handle a non-successful response
		        error : function(xhr,errmsg,err) {
		        	console.log("didn't work2");
		        },

		        complete : function() {

		        	// var event_can_add = false;

		        	console.log(event_can_add);

		        	if (event_can_add == true)
			        {
			        	//If there is no conflicting event, then the global variable will set to addTrue and call the eventAdder function
			        	ajaxAddEventCaller();
			        }
			        else {
			        	//There will be no additional add event because there is an event conflict within the backend
			        	console.log("busy!");
			       }
		        }
			});
		};

		//AJAX call that will do a call to the sync google function on the backend instead of doing a hard page refresh
		function syncGoogleCalendar() {

                $('.ajaxProgress').show();
				$.ajax({
					type: "POST",
					url: "sync/",
					dataType: "json",
					data: {
						csrfmiddlewaretoken: '{{ csrf_token }}',
					},
					success: function() {

						console.log("Got here on success!")
						
						var targetText = "Your Google Sync Information is Syncing.... Please Wait 3 seconds..";
						showGoogleSyncFeedback(targetText);
						setTimeout( function() { hideGoogleSyncFeedback(); location.href = "/dashboard"; }, 3000);	
					},

					error: function() {
						console.log("did i get here?");
					}
				});
			}

		function refresher() {

			//This will not refresh the page, but the following functions reset to NULL values on the frontend for add event form
			setWeekDay();
			setEventName();
			setStartEndTimes();
			$("#event_name_list").text("");
		};

		function ajaxAddEventCaller() {
			//Function that calls the add event form oncomplete after the conflict analysis AJAX call
			create_new_event_form();
		};

		//Pass in a string so the alerts can be dynamic for events, tasks, google events, etc
		function showGoogleSyncFeedback(targetText) {
			var alertMessageType = document.getElementById("updateType");
			alertMessageType.innerHTML = targetText;

			$(".alert-success").css("width", "75%");
			$(".alert-success").css("margin", "auto");
			$(".alert-success").css("margin-top", "50px");
			$(".alert-success").css("margin-bottom", "20px");
			$(".alert-success").css("visibility", "visible");


		}
		function hideGoogleSyncFeedback() {


			$(".alert-success").css("width", "");
			$(".alert-success").css("margin", "");
			$(".alert-success").css("margin-top", "");
			$(".alert-success").css("margin-bottom", "");
			$(".alert-success").css("visibility", "hidden");
		}


		function changeDayVal(day_name) {

			var day_object = document.getElementById("replacement_day");
			day_object.innerHTML = day_name;

		}

		$('.starter_time').timepicker();
		$('.ender_time').timepicker();
		$(".sp-replacer").css("width", "100%");
		$(".sp-replacer").css("margin-bottom", "10px");
		$(".sp-preview").css("width", "100%");
		$(".sp-preview-inner").css("width", "100%");
		$(".sp-dd").remove();
		// sp-replacer sp-light


		function check_for_review_AJAX() {

			//Ajax call into the backend
			$('.ajaxProgress').show();
			$.ajax({
				type: "POST",
				url: "checkreviews/",
				dataType: "json",
				data: {
					csrfmiddlewaretoken: '{{ csrf_token }}',
				},
		        success : function(my_json) {

		        	var count = Object.keys(my_json).length;
		        	var custom_id = 0;

		        	if (count > 0) {
		        		console.log("There are tasks to be reviewed!!!");


		        		for (var date_key in my_json){

		        			var insert_review = document.getElementById("item_date");
		        			var insert_date = document.getElementById("item_date");
		        			console.log(my_json);
		        			insert_date.innerHTML += "<h1>" + date_key + "</h1><hr>";

		        			for (var tasks in my_json[date_key]) {
		        				console.log("FOR THE DATE OF ... " + date_key);
		        				console.log(my_json[date_key][tasks]);
		        				var hour_fix = my_json[date_key][tasks][1];
		        				hour_fix = hour_fix.toFixed(2);
		        				insert_review.innerHTML += '\
		        				\
									<li class="review">	\
									<h1>' + my_json[date_key][tasks][0] + '</h1>\
									</li>';

									insert_review.innerHTML += '<input type="text" style="width: 100%" placeholder="Hours completed out of '+ hour_fix +'"></input>'
								custom_id +=1;
		        			}
		        		}
		        		$("#reviewal_modal").modal('show');
		        	}
		        	else {
		        		console.log("There is nothing that needs to be reviewed");
		        	}

		        },

		        // handle a non-successful response
		        error : function(xhr,errmsg,err) {
		        	console.log("didn't work2");
		        },

			});
		}

</script>

</html>
