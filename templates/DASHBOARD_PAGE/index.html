{% load static %}
{% load staticfiles %}

<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	{% include 'css.html' %}
	{% include 'javascript.html' %}
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <!-- Include Favicon -->
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">

	<title>ArchiTasker - Week Planner Made Simple</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">

    <!-- Bootstrap core CSS     -->
    <link href="{% static 'css/DASHBOARD_CSS/bootstrap.min.css' %}" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="{% static 'css/DASHBOARD_CSS/animate.min.css' %}" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="{% static 'css/DASHBOARD_CSS/light-bootstrap-dashboard.css' %}" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="{% static 'css/DASHBOARD_CSS/demo.css' %}" rel="stylesheet" />


    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="{% static 'css/DASHBOARD_CSS/pe-icon-7-stroke.css' %}" rel="stylesheet" />


<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <style>
      #locationField, #controls {
        position: relative;
        width: 383px;
      }
      #autocomplete {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 99%;
      }
      .label {
        text-align: right;
        font-weight: bold;
        width: 100px;
        color: #303030;
      }
      #address {
        border: 1px solid #000090;
        background-color: #f0f0ff;
        width: 480px;
        padding-right: 2px;
      }
      #address td {
        font-size: 10pt;
      }
      .field {
        width: 99%;
      }
      .slimField {
        width: 80px;
      }
      .wideField {
        width: 200px;
      }
      #locationField {
        height: 20px;
        margin-bottom: 2px;
      }
    </style>

		<script type="text/javascript" charset="utf-8">


            function stringEscape(s) {
                return s ? s.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\t/g,'\\t').replace(/\v/g,'\\v').replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/[\x00-\x1F\x80-\x9F]/g,hex) : s;
                function hex(c) { var v = '0'+c.charCodeAt(0).toString(16); return '\\x'+v.substr(v.length-2); }
            }

			function init() {

                var open_modal_google = function(id, event_color, start, end) {
                    $("#modal_title").html("Google Event Name: <font color=\"" + event_color +"\"><b>" + scheduler.getEvent(id).text + "</b></font>");
                    $("#start_time").html("Start Time: <b>" + start + "</b>");
                    $("#end_time").html("End Time: <b>" + end + "</b>");
                    $('#mymodal').modal('show');
                }

				google_ids = [];

				var currently_selected_id = "";
				var current_view = 0;
				var prev_button = document.getElementsByClassName('dhx_cal_prev_button');
				var next_button = document.getElementsByClassName('dhx_cal_next_button');
				next_button[0].style.visibility='hidden';

				// HANDLE PREVIOUS EVENTS
				for (var i = 0; i < prev_button.length; i++) {
						prev_button[i].addEventListener('click', function() {
								current_view-=1;
								if (current_view > 0) {
									next_button[0].style.visibility='hidden';
								}
								else {
									next_button[0].style.visibility='visible';
								}
						});
				}
				// HANDLE FUTURE EVENTS
				for (var i = 0; i < next_button.length; i++) {
						next_button[i].addEventListener('click', function() {
								current_view+=1;
								if (current_view >= 0) {
									next_button[0].style.visibility='hidden';
								}
								else {
									next_button[0].style.visibility='visible';
								}
						});
				}

				scheduler.config.full_day = true;

				scheduler.config.xml_date="%Y-%m-%d %H:%i";

				scheduler.config.default_date = "%j %M %Y";

				var formatDateFunc = scheduler.date.date_to_str("%Y-%m-%dT%H:%i:%s");

				var weekDay = scheduler.date.date_to_str("%D")

				// I think this is where the bug is where the data posting to the view is causing the error for the start and end times
				var updateDayStatus = function(event_id, ev) {

                    start = stringEscape(scheduler.getEvent(event_id).text);

					$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "create_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							start: formatDateFunc(scheduler.getEvent(event_id).start_date),
							end: formatDateFunc(scheduler.getEvent(event_id).end_date),
							text: start,
							id: scheduler.getEvent(event_id).id,
							weekday: weekDay(scheduler.getEvent(event_id).start_date), //what if the event was a multi-day event?!?!
							color: scheduler.getEvent(event_id).color

						},
					});
				};


                var update_event = function(id, ev, color) {
                    event_text = stringEscape(ev.text);
                    if(typeof color === 'undefined'){
                        $('.ajaxProgress').show();
        					$.ajax({
        						type: "POST",
        						url: "update_event/",
        						dataType: "json",
        						data: {
        							csrfmiddlewaretoken: '{{ csrf_token }}',
        							start: formatDateFunc(scheduler.getEvent(id).start_date),
        							end: formatDateFunc(scheduler.getEvent(id).end_date),
        							text: event_text,
        							id: id
        						},
        					});
        		    		return true;
                    }

                    else {

                    $('.ajaxProgress').show();
    					$.ajax({
    						type: "POST",
    						url: "update_event/",
    						dataType: "json",
    						data: {
    							csrfmiddlewaretoken: '{{ csrf_token }}',
    							start: formatDateFunc(scheduler.getEvent(id).start_date),
    							end: formatDateFunc(scheduler.getEvent(id).end_date),
    							text: event_text,
    							id: id,
                                color: color
    						},
    					});
    		    		return true;
                    };
                };


				var deleteEvent = function(event_id, e) {
					$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "delete_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							id: event_id
						},
					});
					return true;
				};
				// scheduler.config.separate_short_events = true;
				scheduler.config.hour_size_px = 100;
				scheduler.config.scroll_hour = 6;
				scheduler.config.mark_now = true;
                scheduler.config.icons_select = ['icon_details', 'icon_delete', 'i1', 'i2', 'i3', 'i4', 'i5', 'i6', 'i7', 'i8', 'i9', 'i10', 'i11'];

        		scheduler.locale.labels.i1 = "i_1";
        		scheduler.locale.labels.i2 = "i_2";
        		scheduler.locale.labels.i3 = "i_3";
        		scheduler.locale.labels.i4 = "i_4";
                scheduler.locale.labels.i5 = "i_5";
                scheduler.locale.labels.i6 = "i_6";
                scheduler.locale.labels.i7 = "i_7";
                scheduler.locale.labels.i8 = "i_8";
                scheduler.locale.labels.i9 = "i_9";
                scheduler.locale.labels.i10 = "i_10";
                scheduler.locale.labels.i11 = "i_11";

                scheduler._click.buttons.i1 = function(id){
        			scheduler.getEvent(id).color = "#AEA8D3";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#AEA8D3");
        			return "";
        		};

                scheduler._click.buttons.i2 = function(id){
        			scheduler.getEvent(id).color = "#87D37C";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#87D37C");
        			return "";
        		};
                scheduler._click.buttons.i3 = function(id){
        			scheduler.getEvent(id).color = "#BE90D4";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#BE90D4");
        			return "";
        		};

                scheduler._click.buttons.i4 = function(id){
        			scheduler.getEvent(id).color = "#E26A6A";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#E26A6A");
        			return "";
        		};
                scheduler._click.buttons.i5 = function(id){
        			scheduler.getEvent(id).color = "#F9BF3B";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#F9BF3B");
        			return "";
        		};

                scheduler._click.buttons.i6 = function(id){
        			scheduler.getEvent(id).color = "#EB974E";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#EB974E");
        			return "";
        		};
                scheduler._click.buttons.i7 = function(id){
        			scheduler.getEvent(id).color = "#19B5FE";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#19B5FE");
        			return "";
        		};

                scheduler._click.buttons.i8 = function(id){
        			scheduler.getEvent(id).color = "#D2D7D3";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#D2D7D3");
        			return "";
        		};
                scheduler._click.buttons.i9 = function(id){
        			scheduler.getEvent(id).color = "#4B77BE";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#4B77BE");
        			return "";
        		};

                scheduler._click.buttons.i10 = function(id){
        			scheduler.getEvent(id).color = "#26A65B";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#26A65B");
        			return "";
        		};
                scheduler._click.buttons.i11 = function(id){
        			scheduler.getEvent(id).color = "#D24D57";
        			scheduler.updateEvent(id);
        			update_event(id, scheduler.getEvent(id), "#D24D57");
        			return "";
        		};

				scheduler.attachEvent("onEventDeleted", deleteEvent);
				scheduler.attachEvent("onClick", readonly_check);
				scheduler.attachEvent("onDblClick", readonly_check);


				// JS event for the onEventAdded function to do an AJAX call to the database for syncing the new event data
				scheduler.attachEvent("onEventAdded", updateDayStatus);


				scheduler.attachEvent("onEventChanged",function(id,ev){
		    		$('.ajaxProgress').show();
					$.ajax({
						type: "POST",
						url: "update_event/",
						dataType: "json",
						data: {
							csrfmiddlewaretoken: '{{ csrf_token }}',
							start: formatDateFunc(scheduler.getEvent(id).start_date),
							end: formatDateFunc(scheduler.getEvent(id).end_date),
							text: ev.text,
							id: id

						},
					});
		    		return true;
				});

				scheduler.attachEvent("onEventChanged", update_event);


				// Create a new date for gatehring the default times that load into the calendar
				var d = new Date();

				//Get an integer value for getting the full year of the current year in the calendar
				var calendar_year = d.getFullYear();

				//Get the current default month to load into the initial view for the calendar
				var calendar_month = d.getMonth();

				//Get the current day for the calendar to load into the default value for the calendar
				var calendar_day = {{user_day_of_week}};


				scheduler.attachEvent("onBeforeDrag", readonly_check);

				scheduler.config.hour_date = "%g:%i%a";
				// scheduler.config.readonly = true;
				scheduler.init('scheduler_here',new Date(calendar_year,calendar_month,calendar_day),"week");

				scheduler.parse( [

						{% for mon_tasks in mon_TASK %}

							{
								text: "{{mon_tasks}}",
								start_date: '{{ mon_tasks.start_time }}'.substring(0, 10)+" "+'{{ mon_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ mon_tasks.end_time }}'.substring(0, 10)+" "+'{{ mon_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for tues_tasks in tues_TASK %}

							{
								text: "{{tues_tasks}}",
								start_date: '{{ tues_tasks.start_time }}'.substring(0, 10)+" "+'{{ tues_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ tues_tasks.end_time }}'.substring(0, 10)+" "+'{{ tues_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for wed_tasks in wed_TASK %}

							{
								text: "{{wed_tasks}}",
								start_date: '{{ wed_tasks.start_time }}'.substring(0, 10)+" "+'{{ wed_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ wed_tasks.end_time }}'.substring(0, 10)+" "+'{{ wed_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for thurs_tasks in thurs_TASK %}

							{
								text: "{{thurs_tasks}}",
								start_date: '{{ thurs_tasks.start_time }}'.substring(0, 10)+" "+'{{ thurs_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ thurs_tasks.end_time }}'.substring(0, 10)+" "+'{{ thurs_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}
						{% for fri_tasks in fri_TASK %}

							{
								text: "{{fri_tasks}}",
								start_date: '{{ fri_tasks.start_time }}'.substring(0, 10)+" "+'{{ fri_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ fri_tasks.end_time }}'.substring(0, 10)+" "+'{{ fri_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for sat_tasks in sat_TASK %}

							{
								text: "{{sat_tasks}}",
								start_date: '{{ sat_tasks.start_time }}'.substring(0, 10)+" "+'{{ sat_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sat_tasks.end_time }}'.substring(0, 10)+" "+'{{ sat_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}

						{% for sun_tasks in sun_TASK %}

							{
								text: "{{sun_tasks}}",
								start_date: '{{ sun_tasks.start_time }}'.substring(0, 10)+" "+'{{ sun_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sun_tasks.end_time }}'.substring(0, 10)+" "+'{{ sun_tasks.end_time }}'.substring(11, 16),
							},

						{% endfor %}



						{% for monday_tasks in mon %}
						{% if monday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ monday_tasks.task_name }}',
								id: '{{ monday_tasks.special_event_id }}',
								start_date: '{{ monday_tasks.start_time }}'.substring(0, 10)+" "+'{{ monday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ monday_tasks.end_time }}'.substring(0, 10)+" "+'{{ monday_tasks.end_time }}'.substring(11, 16),
								color: '{{ monday_tasks.color }}'
							},
						{% endif %}
						{% endfor %}
						{% for tuesday_tasks in tues %}
						{% if tuesday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ tuesday_tasks.task_name }}',
								id: '{{ tuesday_tasks.special_event_id }}',
								start_date: '{{ tuesday_tasks.start_time }}'.substring(0, 10)+" "+'{{ tuesday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ tuesday_tasks.end_time }}'.substring(0, 10)+" "+'{{ tuesday_tasks.end_time }}'.substring(11, 16),
								color: '{{ tuesday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for wednesday_tasks in wed %}
						{% if wednesday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ wednesday_tasks.task_name }}',
								id: '{{ wednesday_tasks.special_event_id }}',
								start_date: '{{ wednesday_tasks.start_time }}'.substring(0, 10)+" "+'{{ wednesday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ wednesday_tasks.end_time }}'.substring(0, 10)+" "+'{{ wednesday_tasks.end_time }}'.substring(11, 16),
								color: '{{ wednesday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for thursday_tasks in thurs %}
						{% if thursday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ thursday_tasks.task_name }}',
								id: '{{ thursday_tasks.special_event_id }}',
								start_date: '{{ thursday_tasks.start_time }}'.substring(0, 10)+" "+'{{ thursday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ thursday_tasks.end_time }}'.substring(0, 10)+" "+'{{ thursday_tasks.end_time }}'.substring(11, 16),
								color: '{{ thursday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for friday_tasks in fri %}
						{% if friday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ friday_tasks.task_name }}',
								id: '{{ friday_tasks.special_event_id }}',
								start_date: '{{ friday_tasks.start_time }}'.substring(0, 10)+" "+'{{ friday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ friday_tasks.end_time }}'.substring(0, 10)+" "+'{{ friday_tasks.end_time }}'.substring(11, 16),
								color: '{{ friday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for saturday_tasks in sat %}
						{% if saturday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ saturday_tasks.task_name }}',
								id: '{{ saturday_tasks.special_event_id }}',
								start_date: '{{ saturday_tasks.start_time }}'.substring(0, 10)+" "+'{{ saturday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ saturday_tasks.end_time }}'.substring(0, 10)+" "+'{{ saturday_tasks.end_time }}'.substring(11, 16),
								color: '{{ saturday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}
						{% for sunday_tasks in sun %}
						{% if sunday_tasks.authenticated_user.username == current_user %}
							{
								text: '{{ sunday_tasks.task_name }}',
								id: '{{ sunday_tasks.special_event_id }}',
								start_date: '{{ sunday_tasks.start_time }}'.substring(0, 10)+" "+'{{ sunday_tasks.start_time }}'.substring(11, 16),
								end_date: '{{ sunday_tasks.end_time }}'.substring(0, 10)+" "+'{{ sunday_tasks.end_time }}'.substring(11, 16),
								color: '{{ sunday_tasks.color }}'
							},
							{% endif %}
						{% endfor %}

				], "json");

				//Array to store all the currently gathered google events for the user on the calendar

				//Storing all the google events to enable ability to make read-only
				{% for monday_tasks in mon %}
						{% if monday_tasks.is_google_task %}
							google_ids.push('{{ monday_tasks.special_event_id }}');
						{% endif %}
				{% endfor %}
				{% for tuesday_tasks in tues %}
					{% if tuesday_tasks.is_google_task %}
						google_ids.push('{{ tuesday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for wednesday_tasks in wed %}
					{% if wednesday_tasks.is_google_task %}
						google_ids.push('{{ wednesday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for thursday_tasks in thurs %}
					{% if thursday_tasks.is_google_task %}
						google_ids.push('{{ thursday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for friday_tasks in fri %}
					{% if friday_tasks.is_google_task %}
						google_ids.push('{{ friday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for saturday_tasks in sat %}
					{% if saturday_tasks.is_google_task %}
						google_ids.push('{{ saturday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}
				{% for sunday_tasks in sun %}
					{% if sunday_tasks.is_google_task %}
						google_ids.push('{{ sunday_tasks.special_event_id }}');
					{% endif %}
				{% endfor %}

				//Function to deal with making google tasks read only
				function readonly_check(id) {

					var found_google_task = false;

					for (i = 0; i < google_ids.length; i++) {
						if (google_ids[i] == id) {
							found_google_task = true;
						}
					}
					if (found_google_task) {
						var readOnly = scheduler.getEvent(id).readonly;
						scheduler.config.drag_move = true;
						scheduler.config.drag_resize = readOnly;
                        open_modal_google(scheduler.getEvent(id).id, scheduler.getEvent(id).color, formatDateFunc(scheduler.getEvent(id).start_date), formatDateFunc(scheduler.getEvent(id).end_date));
						return false;
					}
					else {
						return true;
					}
				}

                // The goal is to open a modal window for the google events
                function modal_check_for_google(id) {

                    for (i = 0; i < google_ids.length; i++) {
						if (google_ids[i] == id) {
							found_google_task = true;
						}
					}
					if (found_google_task) {

                        open_modal_google(scheduler.getEvent(id).id, scheduler.getEvent(id).color);
						return false;
					}
                }
			}

			$(function() {
			    $( "#datepicker" ).datepicker({
			      // showOn: "button",
			      // buttonImage: "{% static 'datepicker/images/calendar.gif' %}",
			      // buttonImageOnly: true,
			      // buttonText: "Select date",
			      minDate: 0,
			      showAnim: "blind",
			      duration: "slow"

			    });
			});

			

		</script>


		<style type="text/css" media="screen">
			html, body{
				margin:0px;
				padding:0px;
				height:90%;
			}

			.dhx_calendar_click {
				background-color: #C2D5FC !important;
			}

			.pushdown {
				margin-top: 100px;
			}



            @import url(http://fonts.googleapis.com/css?family=Open+Sans:400,700);

            h1 {
              text-align: center;
              font-family: "Open Sans", sans-serif;
              font-size: 22px;
              color: #171717;
              font-weight: 700;
            }
            h1 span {
              font-weight: 400;
            }

            .container {

              min-width: 640px;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-orient: vertical;
              -webkit-box-direction: normal;
              -webkit-flex-direction: column;
                  -ms-flex-direction: column;
                      flex-direction: column;
            }
            .button-container {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-pack: justify;
              -webkit-justify-content: space-between;
                  -ms-flex-pack: justify;
                      justify-content: space-between;
              margin: 60px auto;
            }

            .button {
              border: 0 none;
              border-radius: 36px;
              padding: 5px 55px;
              margin: 0 10px;
              cursor: pointer;
              display: inline-block;
              font-size: 14px;
              color: #fff;
              text-transform: none;
              -webkit-transition: all 80ms ease-in-out;
              transition: all 80ms ease-in-out;
            }
            .button:hover {
              opacity: .7;
            }

            .button.-dark {
              background: #171717;
              color: #FFFFFF;
            }

            .button.-green {
              background: #3AB54A;
              color: #FFFFFF;
            }

            .button.-blue {
              background: #2C96BE;
              color: #FFFFFF;
            }

            .button.-border {
              background: transparent;
              border: 2px solid #2C96BE;
              color: #2C96BE;
            }
            .button.-border:hover {
              border-color: #2C96BE;
              color: #2C96BE;
              opacity: 1;
            }

            #margin-paragraph-from-right {
                margin-right: 20px;
            }

		.dropdown dd, .dropdown dt, .dropdown ul {
			margin: 0px;
			padding: 0px;
			width: 384px;
		}
		.dropdown dd ul li a span:first-child, .dropdown dt a span span:first-child {
			/*background-image: url('http://i.imgur.com/OQiDoZe.png');*/
			background-repeat: no-repeat;
			width: 384px;
			height: 11px;
			display: inline-block;
			margin:0px;
			vertical-align: top;
		}
		.dropdown dt a span {
			width: 384px;
			cursor: pointer;
			display: block;
			padding: 5px;
			white-space: nowrap;
		}
		.dropdown dt a img {
			position: relative;
			z-index: 1;
		}
		.dropdown dt a span span:first-child:before {
			position: absolute;
			content: '';
			width: 15px;
			height: 10px;
			box-shadow: 0 1px 1px rgba(0,0,0,0.2) inset;
		}
		.dropdown dt a span span {
			display: inline-block;
			padding: 0;
		}
		.dropdown dt a span span:first-child {
			padding: 0;
		}
		.dropdown dd {
			position: relative;
		}
		.dropdown a, .dropdown a:visited {
			color: #4a535f;
			text-decoration: none;
			outline: none;
		}
		.dropdown a:hover {
			color: #5d4617;
		}
		.dropdown dt a:hover, .dropdown dt a:focus {
			color: #41A9DA;
			width: 384px;
		}
		.dropdown dt a {
			position: relative;
			background: #e3e6ef;
			display: block;
			padding-right: 20px;
			overflow: hidden;
			border:1px solid #2C3E50;
			width:250px;
		}
		.dropdown dt a:after {
			content: '';
			background: #2C3E50;
			position: absolute;
			
			height: 32px;
		    position: absolute;
		    right: 0;
		    top: 0;
		    width: 35px;
		}

		.dropdown dt a:before {
		    background: none repeat scroll 0 0 #FFFFFF;
		    content: "";
		    height: 3px;
		    position: absolute;
		    right: 7px;
		    top: 6px;
		    width: 20px;
		    z-index: 2;
			box-shadow:0 8px 0 #FFFFFF, 0 16px 0 #FFFFFF;
		}
		.dropdown dd ul {
			background: #f0f2f7;
			
			color: #C5C0B0;
			display: none;
			left: 0px;
			padding: 5px 0px;
			position: absolute;
			
			width: 384px;
			border:1px solid #2C3E50;
			list-style: none;
			max-height: 170px;
			overflow-y: scroll;
			top:10px;
			z-index: 2;
		}

		li a {
			font-size:13px;
		}

		li a span:nth-child(2) {
		    line-height: 2em;
		}
		.dropdown dd ul::-webkit-scrollbar-track {
		 -webkit-box-shadow: inset 0 0 1px rgba(0,0,0,0.3);
		 border-left:1px solid rgba(0,0,0,0.1);
		}
		.dropdown dd ul::-webkit-scrollbar-thumb {
		 background: rgba(0,0,0,0.4);
		/*-webkit-box-shadow: inset 0 0 1px rgba(0,0,0,0.5), 1px 0 0 #5cace9 inset, 2px 0 0 #b3d5ee inset;
		    border-radius:10px;*/
		}
		.dropdown dd ul::-webkit-scrollbar-thumb:window-inactive {
		 background: blue;
		}
		.dropdown span.value {
			display: none;
		}
		.dropdown dd ul li a {
			padding: 5px;
			display: block;
			font-size: 12px !important;
		}
		.dropdown dd ul li a:hover {
			background-color: rgba(0,0,0,0.05);
		}
		dl.dropdown {
			display: inline-block;
			width: 384px;
			margin: -3px 0 0 1px;
		}
		dl.dropdown span:nth-child(3) {
			color: rgba(0,0,0,0.4)
		}
		dl.dropdown > span:nth-child(2) {
			overflow: hidden;
			white-space: nowrap;
			display: inline-block;
		}
		dl.dropdown span:nth-child(3) {
			float: right;
		}
		dl.dropdown dt span:nth-child(2) {
			color: rgba(0, 0, 0, 0.6);
		    font-size: 14px;
		    font-weight: bold;
		    line-height: 1.6em;
		}
		dl.dropdown dt span:nth-child(3) {
			display: none;
		}
		dl {
			background-color: #41A9DA;
			width: 600px;
		}

		.dropdown dt a, .dropdown dt a:focus {
			color: #41A9DA;
			width: 384px;
		}

		.countryFlag {
			padding: 0;
			background-image: url("http://i.imgur.com/OQiDoZe.png");
			background-repeat: no-repeat;
			display: inline-block;
			height: 11px;
			margin-right: 4px;
			width: 16px;
			cursor: pointer;
			white-space: nowrap;
			-moz-border-bottom-colors: none;
			-moz-border-left-colors: none;
			-moz-border-right-colors: none;
			-moz-border-top-colors: none;
			border-color: #BFBFC1 #B6B6B6 #969696;
			border-image: none;
			border-radius: 2px 2px 2px 2px;
			border-style: solid;
			border-width: 1px;
			box-shadow: 0 1px 1px rgba(0, 0, 0, 0.09);
		}


		.wrumper {
			width:383px;
			margin:3% auto;
		}

		</style>
        <style>

            .footer{
                position: absolute;
                left: 0;
                bottom: 0;
                height: 60px;
                width: 100%;
                overflow:hidden;
            }

            /* Paste this css to your style sheet file or under head tag */
            /* This only works with JavaScript,
            if it's not present, don't show loader */
            .no-js #loader { display: none;  }
            .js #loader { display: block; position: absolute; left: 100px; top: 0; }
            .se-pre-con {
            	position: fixed;
            	left: 0px;
            	top: 0px;
            	width: 100%;
            	height: 100%;
            	z-index: 9999;
            	background: url(http://i2.wp.com/smallenvelop.com/wp-content/uploads/2014/08/Preloader_3.gif?zoom=2&resize=64%2C64) center no-repeat #fff;
            }

            #header_text{
                margin-top: 40px;
                font-family: 'Comfortaa', cursive;
                color: #444444;
            }

			/*CSS for collapsing form*/
			#demoTask{
				padding-top: 10px;
			}

		</style>

		<!-- CSS for percent slider -->
		<style>
			#input-select,
			#input-number {
				padding: 7px;
				margin: 15px 5px 5px;
				width: 70px;
			}
		</style>

            <link href='https://fonts.googleapis.com/css?family=Comfortaa:700' rel='stylesheet' type='text/css'>
        <script>

        //paste this code under head tag or in a seperate js file.
        	// Wait for window load
        	$(window).load(function() {
        		// Animate loader off screen
        		$(".se-pre-con").fadeOut("slow");;
        	});

        </script>
</head>
<body onload="init();">

<div class="wrapper">
    <div class="sidebar" data-color="azure" data-image="{% static 'img/DASHBOARD_IMAGES/sidebar-4.jpg' %}">

    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="/dashboard" class="simple-text">
                    Architasker
                    <h6>Welcome back, {{first_name}}!</h6>

                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="/dashboard">
                        <i class="pe-7s-news-paper"></i>
                        <p>Dashboard</p>
                    </a>
                </li>

                <li>
                    <a href="/dashboard">
                        <i class="pe-7s-plus"></i>
                        <p>Add Task</p>
                    </a>
                </li>

                <li>
                    <a href="/settings">
                        <i class="pe-7s-user"></i>
                        <p>Your Account</p>
                    </a>
                </li>


                <li>
                    <a href="#">
                        <i class="pe-7s-bell"></i>
                        <p>Notifications</p>
                    </a>
                </li>



                <li>
                    <a href="#">
                        <i class="pe-7s-help1"></i>
                        <p>Help &amp; Information</p>
                    </a>
                </li>





            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Dashboard</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-left">
                        <li>
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-dashboard"></i>
                            </a>
                        </li>
                        <!-- <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-globe"></i>
                                    <b class="caret"></b>
                                    <span class="notification">5</span>
                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Notification 1</a></li>
                                <li><a href="#">Notification 2</a></li>
                                <li><a href="#">Notification 3</a></li>
                                <li><a href="#">Notification 4</a></li>
                                <li><a href="#">Another notification</a></li>
                              </ul>
                        </li> -->
                        <!-- <li>
                           <a href="">
                                <i class="fa fa-search"></i>
                            </a>
                        </li> -->
                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                           <a href="">
                               Account
                            </a>
                        </li>
                        <!-- <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    Dropdown
                                    <b class="caret"></b>
                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something</a></li>
                                <li class="divider"></li>
                                <li><a href="#">Separated link</a></li>
                              </ul>
                        </li> -->
                        <li>
                            <a href="/logout">
                                Log out
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

				{% if user_initial_setup == True %}


				<center><h3 class="title" id="header_text">{{first_name | title}} {{last_name | title}}'s Weekly To-Do</h3></center>


                {% if google_auth_complete == True %}

                <a href="/sync">
                    <div class='button -border center' style="float: right;">Sync Google Calendar</div>
                </a>


                {% else %}
                <p align="right" id="margin-paragraph-from-right"><a href="/oauth" style="text-align: right">Want To Sync With Google Calendar? Click Here</a></p>
                {% endif %}

				<div class="morph-button morph-button-modal morph-button-modal-1 morph-button-fixed" style="float: left;">
						<button type="button">Add Task</button>
						<div class="morph-content">
							<div>
								<div class="content-style-form content-style-form-1">
									<span class="icon icon-close"></span>
									<section id="advanced-form">
									    <form id="example-advanced-form" action="#">
										    <h3>Task</h3>
										    <section>
										        <legend>Task Information</legend>
										 
										        <label for="taskName-2">Task name *</label>
										        <input id="taskName-2" name="taskName" type="text" class="required">
										        <label for="datepicker">Due Date *</label>
										        <!-- <input id="dueDate-2" name="dueDate" type="text" class="required"> -->
										        <input type="text" id="datepicker" name="dueDate" class="required">

											    <label for="location">Location</label>
<!-- 											    <input id="location" name="location" type="text" placeholder="Primary address this location will be completed in."> -->

											    <div id="locationField">
										      	<input id="autocomplete" name="autocomplete" placeholder="Enter your address"
										             onFocus="geolocate()" type="text"></input>
										    	</div>


												<br><br>
												<div class="wrumper">
												<dl id="country-select" class="dropdown">
												  <dt><a href="javascript:void(0);"><span>Select Transit Mode</span></a></dt>
												  <dd>
												    <ul style="display: none;">
												      <li><a href="javascript:void(0);" onclick=fill_transit('0');><img src="http://i.imgur.com/Ck4NVPl.png"><span style="background-position:0px -1694px"></span><span>Driving</span></a></li>
												      <li><a href="javascript:void(0);" onclick=fill_transit('1');><img src="http://i.imgur.com/mDRDTU7.png"><span style="background-position:0px -1694px"></span><span>Bicycling</span></a></li>
												      <li><a href="javascript:void(0);" onclick=fill_transit('2');><img src="http://i.imgur.com/dEeQtBH.png"><span style="background-position:0px -1694px"></span><span>Walking</span></a></li>
												    </ul>

												  </dd>
												</dl>
												</div>

										    </section>
										 
										    <h3>Details</h3>
										    <section>
										    	<legend>Estimated Time &amp; Priority</legend>
										    	<div>
											    	<label for="percent-2">
											    		Complete <div id="valueOfSlider" style='display:inline-block;'></div> by 
											    		
											    		<select id="task_day_of_week">
											    			<option value="Monday">Monday</option>
											    			<option value="Tuesday">Tuesday</option>
											    			<option value="Wednesday">Wednesday</option>
											    			<option value="Thursday">Thursday</option>
											    			<option value="Friday">Friday</option>
											    			<option value="Saturday">Saturday</option>
											    			<option value="Sunday" selected>Sunday</option>
											    		</select>

											    	</label>
											        <!-- <input id="percent-2" name="percent" type="text" class="required"> -->
											        <div>
												        <input type="number" min="0" max="100" step="1" id="input-number" style='display:inline-block;'>
														<div id="html5" style='width:35%; display:inline-block;'></div>
													</div>
												</div>

												<div style='padding-top: 20px'>
											        <label for="task_time">Estimated time (hours) to complete entire task*</label>
											        <input id="task_time" name="task_time" type="text" class="required">
											    </div>

											    <input id="continuous-2" name="continuous" type="checkbox"> 
										        <label for="continuous-2">No-break continuous task</label>

											    <div style='padding-top: 20px'>
													<label for="radiosSlider">Priority *</label>
					      							<div id="radiosSlider"  style='width:350%'>
													    <input id="value1" name="values" type="radio" value="1">
													    <label for="value1">1</label>

													    <input id="value2" name="values" type="radio" value="2">
													    <label for="value2">2</label>

													    <input id="value3" name="values" type="radio" value="3">
													    <label for="value3">3</label>

													    <input id="value4" name="values" type="radio" value="4">
													    <label for="value4">4</label>

													    <input id="value5" name="values" type="radio" value="5" checked>
													    <label for="value5">5</label>

													    <input id="value6" name="values" type="radio" value="6">
													    <label for="value6">6</label>

													    <input id="value7" name="values" type="radio" value="7">
													    <label for="value7">7</label>

													    <input id="value8" name="values" type="radio" value="8">
													    <label for="value8">8</label>

													    <input id="value9" name="values" type="radio" value="9">
													    <label for="value9">9</label>

													    <input id="value10" name="values" type="radio" value="10">
													    <label for="value10">10</label>
													</div>
												</div>
												
										    </section>
										 
										    <h3>Extras</h3>
										    <section>
										        <legend>Extra Integrations</legend>
										 		<div>
											        <input id="pomodoro-2" name="pomodoro" type="checkbox"> 
											        <label for="pomodoro-2">Pomodoro Timer</label>
											    </div>

											    <label for="url">URL</label>
											    <input id="url" name="url" type="text" placeholder="(Optional)">

											    <label for="comment">Extras/Comments/Description:</label>
											    <textarea name="comment" id="comment" placeholder="(Optional)"></textarea>
										    </section>
										</form>
								   	</section>
								</div>
							</div>
						</div>
					</div><!-- morph-button -->
			
				<div id="scheduler_here" class="dhx_cal_container card col-md-12" style='width:100%; height:70%'>

					 <div class="dhx_cal_navline">
							<div class="dhx_cal_prev_button">&nbsp;</div>
							<div class="dhx_cal_next_button">&nbsp;</div>
							<div class="dhx_cal_today_button"></div>
							<div class="dhx_cal_date"></div>
							<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div>
							<div class="dhx_cal_tab rounding_week_tab" name="week_tab" style="right:140px; border-top-right-radius: 5px; border-bottom-right-radius: 5px;"></div>
					 </div>
					 <div class="dhx_cal_header">
					 </div>
					 <div class="dhx_cal_data pushdown">
					 </div>
				</div>

				 <script>
				// $(document).ready(function(){
				//   $("#demoTask").on("hide.bs.collapse", function(){
				//     $(".btn").html('<span class="glyphicon glyphicon-collapse-down"></span> Add Task');
				//   });
				//   $("#demoTask").on("show.bs.collapse", function(){
				//     $(".btn").html('<span class="glyphicon glyphicon-collapse-up"></span> Close');
				//   });
				// });

				
				// </script>


				{% else %}


				<iframe id="encoder_iframe" height=75% width="100%" src="{% url 'screen_setup_module' %}"></iframe>

				{% endif %}



        <footer id="footerID" class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>
                        <li>
                            <a href="#">
                                Home
                            </a>
                        </li>
                        <li>
                            <a href="https://architasker.wordpress.com/">
                               Blog
                            </a>
                        </li>
                    </ul>
                </nav>
                <p class="copyright pull-right">
                    &copy; 2015 <a href="http://www.creative-tim.com">Architasker</a>, made with love for a better scheduler
                </p>
            </div>
        </footer>
        <input type="hidden" id="hidden_transit"></input>

    </div>
</div>
<div class="modal fade" id = "mymodal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h4 class="modal-title" id="modal_title">Google Event Name: </h4>
      </div>
      <div class="modal-body">
         <p id="start_time"></p>
         <p id="end_time"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script>
		//-----------MORPHING BUTTON/MODAL WINDOW JS---------------------------------
		var docElem = window.document.documentElement, didScroll, scrollPosition;

				// trick to prevent scrolling when opening/closing button
				function noScrollFn() {
					window.scrollTo( scrollPosition ? scrollPosition.x : 0, scrollPosition ? scrollPosition.y : 0 );
				}

				function noScroll() {
					window.removeEventListener( 'scroll', scrollHandler );
					window.addEventListener( 'scroll', noScrollFn );
				}

				function scrollFn() {
					window.addEventListener( 'scroll', scrollHandler );
				}

				function canScroll() {
					window.removeEventListener( 'scroll', noScrollFn );
					scrollFn();
				}

				function scrollHandler() {
					if( !didScroll ) {
						didScroll = true;
						setTimeout( function() { scrollPage(); }, 60 );
					}
				};

				function scrollPage() {
					scrollPosition = { x : window.pageXOffset || docElem.scrollLeft, y : window.pageYOffset || docElem.scrollTop };
					didScroll = false;
				};

				scrollFn();

				var UIBtnn = new UIMorphingButton( document.querySelector( '.morph-button' ), {
					closeEl : '.icon-close',
					onBeforeOpen : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterOpen : function() {
						// can scroll again
						canScroll();
						// form.find(".body:eq(" + 0 + ") label.error").remove();
      //               	form.find(".body:eq(" + 0 + ") .error").removeClass("error");
      //               	form.steps("setStep", 0);
					},
					onBeforeClose : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterClose : function() {
						// can scroll again
						canScroll();
						//resetTaskForm();
					}
				} );

		// -----------FORM STUFF WITHIN MODAL WINDOW----------------------
        var form = $("#example-advanced-form").show();

        form.steps({
            headerTag: "h3",
            bodyTag: "section",
            transitionEffect: "slideLeft",
            enableCancelButton: true,
            onStepChanging: function (event, currentIndex, newIndex)
            {

                

                // Allways allow previous action even if the current form is not valid!
                if (currentIndex > newIndex)
                {
                    return true;
                }
                // Forbid next action on "Warning" step if the user is to young
                if (newIndex === 3 && Number($("#age-2").val()) < 18)
                {
                    return false;
                }
                // Needed in some cases if the user went back (clean up)
                if (currentIndex < newIndex)
                {
                    // To remove error styles
                    form.find(".body:eq(" + newIndex + ") label.error").remove();
                    form.find(".body:eq(" + newIndex + ") .error").removeClass("error");
                }
                form.validate().settings.ignore = ":disabled,:hidden";
                return form.valid();
            },
            onStepChanged: function (event, currentIndex, priorIndex)
            {
                // Used to skip the "Warning" step if the user is old enough.
                if (currentIndex === 2 && Number($("#age-2").val()) >= 18)
                {
                    form.steps("next");
                }
                // Used to skip the "Warning" step if the user is old enough and wants to the previous step.
                if (currentIndex === 2 && priorIndex === 3)
                {
                    form.steps("previous");
                }

                if (currentIndex === 1)
                {
                	console.log(Date.parse('next sunday'));
                    if(Date.parse(document.getElementById("datepicker").value) < Date.parse('next sunday'))
                    {
                    	var task_day = Date.parse(document.getElementById("datepicker").value).toString("dddd");
                    	document.getElementById('task_day_of_week').value = task_day;
                    	document.getElementById("html5").noUiSlider.set(100);
                    	console.log(task_day);
                    }
                }
            },
            onCanceled: function (event) 
            { 
            	resetTaskForm();
            	form.find(".body:eq(" + 0 + ") label.error").remove();
                form.find(".body:eq(" + 0 + ") .error").removeClass("error");
            },
            onFinishing: function (event, currentIndex)
            {
                form.validate().settings.ignore = ":disabled";
                return form.valid();
            },
            onFinished: function (event, currentIndex)
            {
                // alert("Submitted!");

                var url = location_of_task = comment = "None";
                if (!(document.getElementById("url").value === "")) {
                	console.log("Inside url if statement");
                	url = document.getElementById("url").value;
                }

                if (!(document.getElementById("autocomplete").value === "")) {
                	location_of_task = document.getElementById("autocomplete").value;
                }

                if (!(document.getElementById("comment").value === "")) {
                	comment = document.getElementById("comment").value;
                }

                var task_day_date = Date.parse("next" + document.getElementById('task_day_of_week').value);
                var mm = task_day_date.getMonth()+1;
                var dd = task_day_date.getDate();
                var yyyy = task_day_date.getFullYear();

                if(dd<10) {
    				dd='0'+dd;
				} 

				if(mm<10) {
    				mm='0'+mm;
				} 

				task_day_date = yyyy+'-'+mm+'-'+dd;

                console.log("Task name:" + document.getElementById("taskName-2").value);
                console.log("Date:" + document.getElementById("datepicker").value);
                console.log("Percent:" + document.getElementById("input-number").value);
                console.log("Hours:" + document.getElementById("task_time").value);
                console.log("Priority:" + $('input[name="values"]:checked').val());
                console.log("Continuous:" + document.getElementById("continuous-2").checked);
                console.log("Pomodoro:" + document.getElementById("pomodoro-2").checked);
                console.log("Url:" + url);
                console.log("Location:" + location_of_task);
                console.log("Comment:" + comment);
                console.log(Date.parse("next" + document.getElementById('task_day_of_week').value));

                var succeed = false;

                $('.ajaxProgress').show();
				$.ajax({
					type: "POST",
					url: "create_task/",
					dataType: "json",
					data: {
						csrfmiddlewaretoken: '{{ csrf_token }}',
						task_name: document.getElementById("taskName-2").value,
						task_due_date: document.getElementById("datepicker").value,
						task_percent: document.getElementById("input-number").value,
						task_time: document.getElementById("task_time").value,
						task_priority: $('input[name="values"]:checked').val(),
						task_continuous: document.getElementById("continuous-2").checked,
						task_pomodoro: document.getElementById("pomodoro-2").checked,
						task_url: url,
						task_location: document.getElementById("autocomplete").value,
						task_comments: comment,
						task_day_date: task_day_date,
						task_day_num: Date.getDayNumberFromName(document.getElementById('task_day_of_week').value),
						task_transit_mode: document.getElementById("hidden_transit").text
					},
					success: function(json) {

						if (json[0] == 1) {
							succeed = true;
							console.log(json)

							var needed_available_hours = parseFloat(json['needed_available_hours']);
							var available_hours = parseFloat(json['available_hours']);

							var lower_hours = needed_available_hours - available_hours;
							lower_hours = lower_hours.toFixed(2);

							console.log("The task " + json['task_name'] + " has a conflict.");
							console.log("You need " + json['needed_available_hours'] + " hours, but only have " + json['available_hours'] + " hours");
							console.log("This task is only possible if you decrease the required hours by "  + lower_hours);

						}
						else {

							console.log("there is no conflict!");
							location.href = "/dashboard";
						}
					},

					error: function() {

						console.log("did i get here?");
						// location.href = "/dashboard";
					}


				});
				
				UIBtnn.toggle();

				resetTaskForm();


				return succeed;



            }
        }).validate({
            errorPlacement: function errorPlacement(error, element) { element.before(error); },
            rules: {
                task_time: {
                    number: true
                }
            }
        });

        $(document).ready( function(){
        	$("#radiosSlider").radiosToSlider();
    	});

    	function resetTaskForm() {
			document.getElementById("taskName-2").value = "";
				document.getElementById("datepicker").value = "";
				document.getElementById("input-number").value = "";
				document.getElementById("task_time").value = "";
				document.getElementById("continuous-2").checked = false;
				document.getElementById("pomodoro-2").checked = false;
				document.getElementById("url").value = "";
				document.getElementById("location").value = "";
				document.getElementById("comment").value = "";
				document.getElementById("html5").noUiSlider.set(50);
				document.getElementById('task_day_of_week').value = "Sunday";
				// document.getElementById("value5").checked = true;
				// var $radios = $('input:radio[name=values]');
				// $radios.filter('[value=5]').prop('checked', true);
				$("input[name=values][value=" + 5 + "]").prop('checked', true);
				// $("#task_day_of_week").val("Sunday");
				// $("#task_day_of_week").selectmenu('refresh');
				// $('input:radio[name=values]').val("5");

				form.steps("reset");
		};

    </script>

    <!-- Javascript for percent slider -->
    <script>
		var html5Slider = document.getElementById('html5');

		noUiSlider.create(html5Slider, {
			start: 50,
			connect: "lower",
			step: 1,
			range: {
				'min': 0,
				'max': 100
			}
		});

		var inputNumber = document.getElementById('input-number');
		var valueOfSlider = document.getElementById('valueOfSlider');

		html5Slider.noUiSlider.on('update', function( values, handle ) {

			var value = values[handle];
			inputNumber.value = Math.round(value);
			valueOfSlider.innerHTML = Math.round(value) + "%";
		});


		inputNumber.addEventListener('change', function(){
			html5Slider.noUiSlider.set([this.value]);
		});
	</script>

</body>
<div class="se-pre-con"></div>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>

<!--   Core JS Files   -->
<!-- <script src="{% static 'js/DASHBOARD_JAVASCRIPT/jquery-1.10.2.js'%}" type="text/javascript"></script> -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap.min.js' %}" type="text/javascript"></script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBV1nboJgNwEtCcsowDe9f6bf4WGZaj7ao&signed_in=true&libraries=places&callback=initAutocomplete"
        async defer></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap-checkbox-radio-switch.js' %}"></script>

<!--  Charts Plugin -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/chartist.min.js' %}"></script>

<!--  Notifications Plugin    -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/bootstrap-notify.js' %}"></script>

  <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/light-bootstrap-dashboard.js' %}"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="{% static 'js/DASHBOARD_JAVASCRIPT/demo.js' %}"></script>

	<script type="text/javascript">
			{% if user_initial_setup == False %}
    	$(document).ready(function(){
        	$.notify({
            	icon: 'pe-7s-bell',
            	message: "Welcome to Architasker! Get started by setting up your account so we can begin adding tasks."

            },{
                type: 'info',
                timer: -1
            });
    	});

        {% if google_auth_complete %}

        setTimeout(function(){  }, 500);
            //If the user has already authorize timezone and OAUTH2
            $('#encoder_iframe').load(function(){

                    //Grab the inner iFrame
                    var iframe = $('#encoder_iframe').contents();

                    //Click the initial next button
                    iframe.find("#next").click();

                    //Set timeout for load and then next again for the final set
                    setTimeout(function(){ iframe.find("#next_again").click(); }, 1000);

            });

        {% endif %}


		{% endif %}


 function setCountry(code){
        if(code || code==''){
            var text = jQuery('a[cunt_code="'+code+'"]').html();
            $(".dropdown dt a span").html(text);
        }
    }
    $(document).ready(function() {
        $(".dropdown img.flag").addClass("flagvisibility");

        $(".dropdown dt a").click(function() {
            $(".dropdown dd ul").toggle();
        });

        $(".dropdown dd ul li a").click(function() {
            //console.log($(this).html())
            var text = $(this).html();
            $(".dropdown dt a span").html(text);
            $(".dropdown dd ul").hide();
            $("#result").html("Selected value is: " + getSelectedValue("country-select"));
        });

        function getSelectedValue(id) {
            //console.log(id,$("#" + id).find("dt a span.value").html())
            return $("#" + id).find("dt a span.value").html();
        }

        $(document).bind('click', function(e) {
            var $clicked = $(e.target);
            if (! $clicked.parents().hasClass("dropdown"))
                $(".dropdown dd ul").hide();
        });


        $("#flagSwitcher").click(function() {
            $(".dropdown img.flag").toggleClass("flagvisibility");
        });
    });



var placeSearch, autocomplete;
var componentForm = {
  street_number: 'short_name',
  route: 'long_name',
  locality: 'long_name',
  administrative_area_level_1: 'short_name',
  country: 'long_name',
  postal_code: 'short_name'
};

function initAutocomplete() {
  // Create the autocomplete object, restricting the search to geographical
  // location types.
  autocomplete = new google.maps.places.Autocomplete(
      /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
      {types: ['geocode']});

  // When the user selects an address from the dropdown, populate the address
  // fields in the form.
  autocomplete.addListener('place_changed', fillInAddress);
}

function fillInAddress() {
  // Get the place details from the autocomplete object.
  var place = autocomplete.getPlace();

  for (var component in componentForm) {
    document.getElementById(component).value = '';
    document.getElementById(component).disabled = false;
  }

  // Get each component of the address from the place details
  // and fill the corresponding field on the form.
  for (var i = 0; i < place.address_components.length; i++) {
    var addressType = place.address_components[i].types[0];
    if (componentForm[addressType]) {
      var val = place.address_components[i][componentForm[addressType]];
      document.getElementById(addressType).value = val;
    }
  }
}

// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
}

function fill_transit(trans_type) {

	trans_text = document.getElementById("hidden_transit");
	trans_text.text = trans_type;
}


		function getFreeHours() {

                $('.ajaxProgress').show();
				$.ajax({
					type: "POST",
					url: "check_free_hrs/",
					dataType: "json",
					data: {
						csrfmiddlewaretoken: '{{ csrf_token }}',
					},
					success: function(json) {
						succeed = true;
						console.log(json);
					},

					error: function() {

						console.log("did i get here?");
				
					}


				});

		}






	</script>


</html>
